<div ng-class="{'whirl no-overlay':showLoader || generatePdf.showLoader}"></div>
<<<<<<< HEAD

<div style="margin-bottom: 13px;">

    <div class="row"

         style="margin-bottom: 7px !important;">

        <div class="col-md-5">

            <button type="button"

                    class="btn btn-default2"

                    style="color:#2196F3;margin-left: 0;"

                    ng-click="clearAndSearchItems()"

                    ng-if="rec.type == 3 && submit_show_invoicee && !show_recieve_list"

                    ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select Item</button>

            <!--  selectItem(0, 1,rec) -->

            <span ng-if="rec.type == 3 && rec.order_code"

                  style="margin-left: 4px;"

                  ng-controller="SetupController"

                  ng-init="callbackAfterMigration = callbackAfterItemsMigration; callbackBeforeMigration = callbackBeforeItemsMigration"

                  class="ib"

                  ng-class="{'disable-el2':show_recieve_list || approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)}">

                <button type="button"

                        class="btn btn-default2"

                        ng-click="show_migrate_pop('Purchase-Orders-Items')"

                        style="color:#2196F3;margin-left: 0;">Upload Items</button>

                <div ng-include="'app/views/import_file.html'"></div>

            </span>

            <button type="button"

                    class="btn btn-default2 dont-click"

                    title="Stock Received"

                    style="color:#2196F3"

                    ng-click="clearAndSearchItems()"

                    ng-if="rec.type == 3 && submit_show_invoicee && show_recieve_list"

                    ng-disabled="show_recieve_list">Select Item</button><!-- selectItem(0, 1,rec) -->

            <button class="btn btn-default2"

                    type="button"

                    style="color:#2196F3"

                    ng-click="selectItem(1, 1,rec)"

                    ng-if="rec.type == 3 && submit_show_invoicee"

                    ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select G/L</button>

            <button class="btn btn-default2"

                    type="button"

                    style="color:#2196F3"

                    title="Select Item Additional Cost"

                    ng-click="selectItem(2, 1,rec)"

                    ng-if="rec.type == 3 && submit_show_invoicee && !show_recieve_list && inventorySetup != 2"

                    ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select Item Add. Cost</button>

            <button class="btn btn-default2"

                    type="button"

                    style="color:#2196F3"

                    title="Select Item Additional Cost"

                    ng-if="rec.type == 3 && submit_show_invoicee && show_recieve_list && inventorySetup != 2"

                    ng-disabled="show_recieve_list">Select Item Add. Cost</button>



        </div><!-- {{arr_vat_post_grp}}== {{order_posting_group_id}} -->

    </div>

    <table class="table table-striped table-bordered no-readonly">

        <thead ng-if="rec.type == 3 || rec.type == 2"

               class="fixit">

            <tr>

                <th style="width: 44px;">Type</th>

                <th style="width: 75px;">No.</th>

                <th style="width: 180px;">Description</th><!-- width: 220px; -->

                <th class="text-right">Qty.</th>

                <th style="width: 62px;">U.O.M</th>

                <th style=" width:10% ">Warehouse</th><!-- width:17%-->

                <th class="text-right">Unit Price</th>

                <th style="width: 7%">Discount Type</th>

                <th class="text-right">Discount</th> 

                <th>VAT Rate</th>

                <th class="text-right">Original<br />Amount</th> 

                <th class="text-right">Discount<br /> Amount </th> 

                <th class="text-right"> Total<br />  Amount </th>

                <th class="text-right">VAT</th>

                <th style="width: 60px;">Action</th>

            </tr>

        </thead>

        <tbody ng-show="(rec.type == 3 || rec.type == 2)"

               class="fixit">

            <tr ng-repeat="(key,item) in items"

                ng-class="{ 't-partiallyallocated': (item.item_type == 0 && item.purchase_status==0 && item.remainig_qty > 0  && item.remainig_qty !=item.qty) || (item.item_type == 2 && item.purchase_status && item.remainingAdditionalCost > 0), 

                't-allocatedstock': (!show_recieve_list && item.item_type == 0 && showReceiveStuff && item.remainig_qty == 0) || (!show_recieve_list && item.item_type == 2 && item.purchase_status ==0 && item.remainingAdditionalCost == 0) ,

                't-stockreceived' : (show_recieve_list && item.item_type == 0 && showReceiveStuff) || (!(rec.type == 3) && item.item_type == 0)}">

                <td style="width: 44px;"

                    ng-if="item.item_type == 0">

                    <select disabled="disabled"

                            class="form-control"

                            style="background: none; border: 0; padding: 0;">

                        <option>Item</option>

                    </select>

                </td>

                <td style="width: 44px;"

                    ng-if="item.item_type == 1">

                    <select disabled="disabled"

                            class="form-control"

                            style="background: none; border: 0; padding: 0;">

                        <option>G/L

                            <!-- Account -->

                        </option>

                    </select>

                </td>

                <td style="width: 44px;"

                    ng-if="item.item_type == 2"

                    title="Item Additional  Cost">

                    <select disabled="disabled"

                            class="form-control">

                        <option>IAC

                            <!-- Add. Item <br> Cost -->

                        </option>

                    </select>

                </td>

                <td ng-if="item.item_type == 0 || item.item_type == 1"

                    style="    width: 75px;"

                    title="{{item.product_code}}">{{item.product_code}}

                    <a title="Landing Cost Setup"

                       class="tooltips_clsss btn "

                       ng-if="item.total_landing_cost>0"

                       ng-click="show_landing_cost_detail(item.supplier_id,item.id)">

                        <i class="fa fa-eye"></i>

                    </a>

                </td>

                <td ng-if="item.item_type == 2"

                    style="    width: 75px;"

                    title="{{item.code}}">{{item.code}}</td>

                <td style="width: 180px;"

                    title="{{item.product_name}}"><!--width: 220px;  -->

                    <input type="text"

                           class="form-control input_text"

                           ng-model="item.product_name"

                           ng-readonly="approvals_lock_order == 1 || check_srm_readonly || show_recieve_list">

                </td>

                <td class="text-right">

                    <!-- item.remainig_qty == 0 ||  -->

                    <input class="form-control input_text text-right"

                           type="number"

                           ng-readonly=" approvals_lock_order == 1 || check_srm_readonly || (show_recieve_list && item.item_type != 1)"

                           ng-if="!check_srm_readonly"

                           ng-change="!check_srm_readonly && check_min_max(item)"

                           ng-blur="!check_srm_readonly && UpdateQty(item)"

                           ng-model="item.qty"

                           min="0"

                           oninput="validity.valid||(value='');"

                           step="any">

                    <span ng-if="check_srm_readonly">{{item.qty | numberNoDecimalsIfZeroFilter:2:''}}</span>

                </td>

                <td style="width: 62px;">

                    <select class="form-control"

                            ng-if="item.item_type == 0"

                            ng-model="item.units"

                            ng-change="!check_srm_readonly && check_min_max(item)"

                            ng-options="opt as opt.name for opt in item.arr_units"

                            ng-disabled="item.item_type == 0 || show_recieve_list  || approvals_lock_order == 1 || check_srm_readonly">

                        <option style="display:none"

                                value=""></option>

                    </select><!-- +'('+opt.quantity+')' -->

                    <select class="form-control"

                            required

                            ng-model="item.units"

                            ng-if="item.item_type == 1"

                            ng-options="opt as opt.title for opt in gl_arr_units track by opt.id"

                            ng-disabled="approvals_lock_order == 1 || check_srm_readonly">

                        <option value=""></option>

                        <!--  || show_recieve_list -->

                        <!--+'('+opt.quantity+')'-->

                    </select>

                    <span ng-if="item.item_type == 2">{{item.units}}</span>

                    <!-- <select class="form-control" disabled

                        ng-if=" item.item_type == 2" 

                        ng-model="item.units" 

                        ng-options="opt as opt.title for opt in service_arr_units">

                        <option style="display:none" value=""></option>

                    </select> -->

                </td>

                <td style="width:10%"

                    ng-if="item.item_type == 0"><!-- width:17% -->

                    <!-- item.warehouse_id >0  ||  ng-attr-title bootstrap-tooltip ng-if="item.warehouses.name || 1"  overflow: visible;  class="tooltipa"-->

                    <!-- ng-if="item.stock_check == 1" -->

                    <select class="form-control "

                            title="{{item.warehouses.name}} ({{item.warehouses.available_quantity}})"

                            ng-disabled="(item.remainig_qty < item.qty) || approvals_lock_order == 1 || check_srm_readonly || show_recieve_list "

                            ng-if="!check_srm_readonly"

                            ng-model="item.warehouses"

                            ng-options="opt as opt.name +' ('+opt.available_quantity+')' for opt in item.arr_prod_warehouse">

                        <option style="display:none"

                                value=""></option>

                    </select>



                    <span style="white-space: nowrap;"

                          title="{{item.warehouses.name}} ({{item.warehouses.available_quantity}})"

                          ng-if="check_srm_readonly && item.warehouses">{{item.warehouses.name}}

                        ({{item.warehouses.available_quantity}})</span>

                </td>

                <td style="width:10%"

                    ng-if="item.item_type == 2">&nbsp;</td><!-- width:17% -->

                <td style="width:10%"

                    ng-if="item.item_type == 1">&nbsp;</td><!-- width:17% -->

                <td class="text-right">

                     <input  type="text" class="form-control input_text text-right" oninput="validateDecimalPoints(this, 5)"

                        ng-readonly="approvals_lock_order == 1 || check_srm_readonly" 

                        ng-model="item.standard_price"                        

                        ng-blur="!check_srm_readonly && UpdateStandardPrice(item)" 

                        ng-change="checkItemPrice(item)" 

                        ng-if="!check_srm_readonly"> 



                    <!-- type="number" step="any" -->

                    <!-- <x-expression-eval ng-model="item.standard_price"

                                       step="any"

                                       ng-if="!check_srm_readonly"

                                       class="text-right"

                                       id="standard_price"

                                       x-value='item.standard_price'

                                       enable-percentage='1'

                                       title="Add expression * + - () / % and press tab to recalculate Unit Price"

                                       ng-blur="UpdateStandardPrice(item)"

                                       ng-change="checkItemPrice(item)">

                    </x-expression-eval> -->

                    <span ng-if="check_srm_readonly"

                          title="{{item.standard_price | unitPriceFilter}}">{{item.standard_price | unitPriceFilter}}</span>

                </td>

                <td style="width: 7%">

                    <select class="form-control"

                            ng-disabled="approvals_lock_order == 1 || check_srm_readonly"

                            ng-if="item.isGLVat!=true"

                            ng-model="item.discount_type_id"

                            ng-change="onChangeDiscountType(item);UpdateStandardPrice(item,1);"

                            ng-options="opt as opt.name for opt in arr_discount_type">

                        <option style="display:none"

                                value=""></option>

                    </select>

                </td>

                <td class="text-right">

                    <div class="input-symbol">

                        <input type="number"

                               min="0"

                               step="0.01"

                               class="form-control input_text text-right"

                               ng-readonly="approvals_lock_order == 1 || check_srm_readonly"

                               ng-change="onChangeDiscountType(item);"

                               ng-blur="!check_srm_readonly && UpdateStandardPrice(item,1)" 

                               ng-pattern="/^[0-9]+(\.[0-9]{1,9})?$/"

                               ng-model="item.discount"

                               ng-if="!check_srm_readonly && item.isGLVat!=true">

                    </div>

                    <span ng-if="item.discount_type_id.id && check_srm_readonly">{{item.discount | currency:""}}</span>

                    <span ng-show="item.discount_type_id.id == 'Percentage' && check_srm_readonly">&#37;</span>

                </td> 

                <td title="{{item.vats.name}}">

                    <select class="form-control"

                            ng-disabled="approvals_lock_order == 1 || check_srm_readonly"

                            ng-model="item.vats"

                            ng-if="item.isGLVat!=true"

                            ng-options="opt as opt.name for opt in arrVATPostGrpPurchase  track by opt.id">

                        <!-- arr_vat -->

                        <option style="display:none"

                                value=""></option>

                        <!-- arr_vat_post_grp[order_posting_group_id] -->

                    </select>

                </td>

                <td class="text-right"

                    title="{{(item.isGLVat==true) ? 0 : item.standard_price * item.qty | currency:''}}">

                    {{(item.isGLVat==true) ? 0 : item.standard_price * item.qty | currency:"" }}</td>  

                <!-- <td class="text-right"

                    title="{{rowOriginalAmount(item) | currency:''}}">{{rowOriginalAmount(item) | currency:''}}</td>  -->

                <td class="text-right"

                    title="{{rowDiscount(item)  | currency:'' }} "> {{rowDiscount(item) | currency:""}} </td>

                <td class="text-right"

                    title="{{item.total_price = rowTotal(item) | currency:''}}">{{item.total_price =

                    rowTotal(item) | currency:""}}

                </td>

                <td class="text-right"

                    title=" {{item.vatPrice = rowVat(item) | currency:''}}"> {{item.vatPrice = rowVat(item) |

                    currency:""}}

                </td>

                <!-- | number:2 &nbsp{{rec.currency_id.code}} -->

                <td ng-if="rec.type == 3 || rec.type == 2"

                    style="    width: 60px;padding-right: 15px;padding-left: 2px;">



                    <span ng-if="item.item_type == 0">

                        <a title="{{ item.purchase_status == 1 ? 'Stock Allocation Completed' : 'Allocate Stock'}}"

                           ng-if="item.stock_check == 1"

                           ng-click="get_warehouse(item,rec,$index)"

                           ng-class="{'dont-click':!show_recieve_list_anchor}">

                            <i class="fa fa-cubes"

                               ng-class="{ 'in-comp-alloc' : item.purchase_status == 0 && item.remainig_qty > 0 && item.remainig_qty !=item.qty, 

                                            'comp-alloc': !show_recieve_list && showReceiveStuff && item.remainig_qty == 0 ,

                                            'item-dispatch' : (show_recieve_list && showReceiveStuff) || !(rec.type == 3)}"></i>

                            <!-- <i class="fa fa-cubes" 

                                ng-class="{ 'in-comp-alloc' : item.purchase_status == 0 && item.remainig_qty > 0, 

                                            'comp-alloc': item.purchase_status != 2 && item.remainig_qty == 0 ,

                                            'item-dispatch' : item.purchase_status == 2}"></i> -->

                        </a>

                        <!-- !check_srm_readonly || (InvoiceChk) &&  -->

                        <!-- {{item.remainig_qty}}/// {{item.qty}}  == {{item.qtyItemAllocated}} -->



                        <!-- <a ng-if="item.stock_check == 0 "

                           class="btn"

                           style="padding:3px 9px;"

                           ng-title="{{ item.sale_status && item.remainig_qty == 0 ? 'Stock Allocation Completed' : 'Allocate Stock'}}">

                            <i class="fa fa-stop"

                               style="position: relative;top: -2px; "

                               ng-class="{'item-dispatch' : item.purchase_status == 2 }"></i>

                            

                        </a> -->

                    </span>

                    <span ng-if="item.item_type == 2">

                        <a class="btn"

                           ng-title="Item Additional Cost"

                           ng-click="getAdditionalItemCost(item,rec,$index)">

                            <i class="fa fa-plus-square-o"

                               style=" position: relative; top: -2px;"

                               ng-class="{'in-comp-alloc' : item.purchase_status && item.remainingAdditionalCost > 0, 

                                            'comp-alloc': !show_recieve_list && item.purchase_status ==0 && item.remainingAdditionalCost == 0,

                                            'item-dispatch' : show_recieve_list && showReceiveStuff && item.remainingAdditionalCost == 0}"></i>

                            <!-- 

                                <i class="fa fa-plus-square-o" 

                                ng-class="{'in-comp-alloc' : item.purchase_status && item.remainingAdditionalCost > 0, 

                                            'comp-alloc': item.purchase_status != 2 && item.remainingAdditionalCost == 0,

                                            'item-dispatch' : item.purchase_status == 2}"></i>

                             -->

                            <!-- {{item.remainingAdditionalCost}}=={{item.purchase_status}} -->

                        </a>

                    </span>



                    <a title="Delete"

                       style="float: right;margin-right: 3px;"

                       ng-if="!show_recieve_list || item.item_type == 1 || item.item_type == 2"

                       ng-click="deleteOrderLine($index, item, items) "

                       ng-class="{'dont-click':!show_recieve_list_anchor || approvals_lock_order == 1 || check_srm_readonly}">

                        <i class="fa fa-times"></i>

                    </a>

                </td>

            </tr>

            <tr ng-show="items.length ==0 ">

                <td>&nbsp;</td>

                <td>&nbsp;</td>

                <td>&nbsp;</td>

                <td>&nbsp;</td>

                <td>&nbsp;</td>

                <td><input type="text"

                           value=""

                           readonly="readonly"

                           class="form-control"></td>

                <td><input type="text"

                           value=""

                           readonly="readonly"

                           class="form-control"></td>

                <td><input type="text"

                           value=""

                           readonly="readonly"

                           class="form-control"></td>

                <td>&nbsp;</td>

                <td>&nbsp;</td> 

                <td>&nbsp;</td>

                <td>&nbsp;</td>

                <td>&nbsp;</td>

            </tr>

        </tbody>

    </table>

</div>

<div ng-class="{'col-md-2': (showVolumeWeight>0 && showReceiveStuff), 'col-md-3': !(showVolumeWeight>0 && showReceiveStuff)}"

     style="padding-left: 0;" title="Internal Note">

    <textarea rows="4"

              cols="30"

              maxlength="500"

              placeholder="Add Internal Note"

              class="form-control ng-pristine ng-valid ng-binding ng-valid-maxlength ng-touched"

              ng-model="rec.note"

              style="resize: none;height: 90px !important;    margin-bottom: 10px; color: green;"

              ng-change="showWordsLimits_invoice()"

              ng-disabled="check_srm_readonly"></textarea>

    <span class="word-counter">{{wordsLength}}/500</span>

</div>
<div ng-class="{'col-md-5': (showVolumeWeight>0 && showReceiveStuff), 'col-md-6': !(showVolumeWeight>0 && showReceiveStuff)}"
     style="padding-left: 0;" title="External Note">
    <textarea rows="4"
              cols="30"
              maxlength="500"
              placeholder="Add External Note" 
              class="form-control ng-pristine ng-valid ng-binding ng-valid-maxlength ng-touched"
              ng-model="rec.externalnote"
              style="resize: none;height: 90px !important;    margin-bottom: 10px; color: red;"
              ng-change="showWordsLimits_invoice()"
              ng-disabled="check_srm_readonly"></textarea>
    <span class="word-counter">{{wordsLength}}/500</span>
</div>



<div class="col-md-2 no-padding"

     id="total-amout"

     ng-if="showVolumeWeight>0 && showReceiveStuff">

    <table class="invoice_total">

        <tr ng-if="volume !=0 && volume_permission>0">

            <td class="text-left">Total Volume</td>

            <td class="text-right">{{volume | quantityNum:2:''}} <span

                      ng-if="volume_unit == 'cm3'">cm&sup3;</span><span

                      ng-if="volume_unit != 'cm3'">{{volume_unit}}</span></td>

        </tr>

        <tr ng-if="weight !=0 && weight_permission>0">

            <td class="text-left">Total Weight</td>

            <td class="text-right">{{weight | quantityNum:2:''}} {{weightunit}}</td>

        </tr>

    </table>

    <div>

    </div>

    <div class="clearfix">&nbsp;</div>

</div>

<div class="col-md-3 no-padding"

     id="total-amout">

    <div class="invoice_items-total no-margin">

        <table class="invoice_total">

            <tr ng-if="calcDiscount()>0">

                <td class="text-right">Discount</td>

                <td class="text-right">{{calcDiscount() | currency:""}}&nbsp;{{rec.currency_id.code}} </td>

            </tr> 

            <tr>

                <td class="text-right">Amount</td>

                <td class="text-right"> {{netTotal() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>

            </tr>

            <tr>

                <td class="text-right">VAT</td>

                <td class="text-right">{{calcVat() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>

            </tr>

            <tr>

                <td class="text-right">Amount Incl. VAT</td>

                <td class="text-right">{{grandTotal() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>

            </tr>

        </table>

    </div>

</div>

<div class="row">

    <div class="col-md-12"

         style="margin-top: 13px;">

        <div id="curent">

            <div id="curent_2">

                <div class="pull-left"

                     ng-if="showReceiveStuff">

                    <span class="margin-right">

                        <i class="fa fa-circle"

                           style="color:#ef7372;"></i> Partially Allocated </span>

                    <span class="margin-right">

                        <i class="fa fa-circle"

                           style="color:#25b726;"></i> Allocated Stock </span>

                    <span class="margin-right">

                        <i class="fa fa-circle "

                           style="color:#ffd351;"></i> Stock Recieved</span>

                </div>

            </div>

        </div>

        <emailer ng-if="items.length > 0 && check_srm_readonly == true"

                     x-hide-button="true"

                     x-page-name="Purchases_ReceiptNote"

                     x-parent-record-id="rec.id"

                     x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}'

                     x-to="supplierOrderEmail"

                     x-to-array="rec.supplier_emails.Emails"

                     x-modal-title="Goods Receipt Note No. {{rec.order_code}}"

                     x-record-against="Supplier"

                     x-pdf-generator="showInvoiceModal('receiptNote',1)"

                     x-button-title="Receipt Note"

                     x-data-obj="rec"

                     x-pdf-ready="serviceVariables.generatedPDF"

                     x-html-destroy="purchase_order_modal">

            </emailer><!--  && rec.payable_bank -->

        <div class="pull-right"

             ng-show="(rec.type == 3) && submit_show_invoicee">

            <!-- <button class="btn btn-delete active-btns" type="button" 

                ng-click="deletePurchaseOrder()"

                ng-show="rec.id>0"> Delete </button> -->

            <button class="btn btn-default"

                    ng-disabled="!check_srm_readonly"

                    ng-click="GetApprovalStatus()"

                    ng-if="items.length > 0 && purchase_order_approval_req > 0">Approval History</button>

            <emailer ng-if="rec.order_code && items.length > 0 && check_srm_readonly == true"

                     x-hide-button="true"

                     x-page-name="Purchases_PurchaseOrders"

                     x-parent-record-id="rec.id"

                     x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}'

                     x-to="supplierOrderEmail"

                     x-to-array="rec.supplier_emails.Emails"

                     x-modal-title="{{rec.order_code}}"

                     x-record-against="Supplier"

                     x-pdf-generator="showInvoiceModal('purchaseOrder',1)"

                     x-button-title="Purchase Order"

                     x-data-obj="rec"

                     x-pdf-ready="serviceVariables.generatedPDF"

                     x-html-destroy="purchase_order_modal">

            </emailer>







            <emailer ng-if="items.length > 0 && check_srm_readonly == true"

                     x-hide-button="true"

                     x-page-name="Purchases_ReceiptNote"

                     x-parent-record-id="rec.id"

                     x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}'

                     x-to="supplierOrderEmail"

                     x-to-array="rec.supplier_emails.Emails"

                     x-modal-title="Goods Receipt Note No. {{rec.order_code}}"

                     x-record-against="Supplier"

                     x-pdf-generator="showInvoiceModal('receiptNote',1)"

                     x-button-title="Receipt Note"

                     x-data-obj="rec"

                     x-pdf-ready="serviceVariables.generatedPDF"

                     x-html-destroy="purchase_order_modal">

            </emailer><!--  && rec.payable_bank -->



            <button class="btn btn-default"

                    type="button"

                    ng-click="showInvoiceModal('purchaseOrder')"

                    ng-show="items.length > 0 && check_srm_readonly == true">

                Purchase Order

            </button><!--   && rec.payable_bank -->



            <button class="btn btn-default"

                    type="button"

                    ng-if="items.length > 0 && show_recieve_list && showReceiveStuff"

                    ng-show="items.length > 0 && check_srm_readonly == true"

                    ng-click="showInvoiceModal('receiptNote')">

                Goods Receipt Note

            </button>



            <!-- <button class="btn btn-default"

                    ng-disabled="!check_srm_readonly"

                    ng-if="items.length > 0 && check_srm_readonly == true  && rec.payable_bank && showReceiveStuff"

                    ng-click="showInvoiceModal('purchaseDelivery');"

                    type="button">Delivery Note

            </button>          



            <emailer id="deliveryNoteEmailer"

                     ng-if="items.length > 0 && check_srm_readonly == true  && rec.payable_bank && showReceiveStuff"

                     x-hide-button="true"

                     x-page-name="Purchases_DeliveryNotes"

                     x-to="supplierOrderEmail"

                     x-to-array="rec.supplier_emails.Emails"

                     x-record-against="Customer"

                     x-modal-title="{{rec.order_code}}"

                     x-parent-record-id="rec.id"

                     x-parent-record-name='{{rec.order_code +

                    ((rec.order_code && rec.invoice_code)?"/":"") +

                    (rec.invoice_code?rec.invoice_code:"") + " - " + rec.bill_to_name}}'

                     x-pdf-generator="showInvoiceModal('purchaseDelivery', 1)"

                     x-data-obj="rec"

                     x-button-title="DN Confirmation"

                     x-pdf-ready="serviceVariables.generatedPDF">

            </emailer>



            <button class="btn btn-default"

                    ng-disabled="!check_srm_readonly"

                    ng-if="items.length > 0 && check_srm_readonly == true && rec.payable_bank && showReceiveStuff"

                    ng-click="showInvoiceModal('purchaseWarehouse');"

                    type="button">W/H Instructions </button>

            <emailer id="warehouseInstructionsEmailer"

                     ng-if="items.length > 0 && check_srm_readonly == true && rec.payable_bank && showReceiveStuff"

                     x-hide-button="true"

                     x-page-name="Purchases_WarehouseInstructions"

                     x-to="supplierOrderEmail"

                     x-to-array="allWarehouseEmails"

                     x-record-against="Warehouse"

                     x-modal-title="{{rec.order_code}}"

                     x-parent-record-id="rec.id"

                     x-parent-record-name='{{rec.order_code +((rec.order_code && rec.invoice_code)?"/":"") +

                    (rec.invoice_code?rfixSummernote3ec.invoice_code:"") + " - " + rec.bill_to_name}}'

                     x-pdf-generator="showInvoiceModal('purchaseWarehouse', 1)"

                     x-data-obj="rec"

                     x-button-title="W/H Instructions Confirmation"

                     x-pdf-ready="serviceVariables.generatedPDF">

            </emailer> -->





            <!-- <button class="btn btn-default" type="button"

                ng-if="items.length > 0"

                ng-disabled="check_srm_readonly"

                ng-click="showInvoiceModal('purchaseOrder')">

                View Order</button> -->



            <!-- <button class="btn btn-default"

                    type="button"

                    ng-click="convert_to_sales_order(rec2,rec);"

                    ng-if="items.length > 0 && rec.is_whole_seller > 0"

                    ng-disabled="!check_srm_readonly"

                    ng-readonly="show_invoice">

                <i class="fa fa-check fa_display"></i>Convert To SO

            </button> -->

            <button class="btn btn-default"

                    type="button"

                    ng-click="convert_post_invoice(rec2,rec)"

                    ng-if="items.length > 0 && allowpost_prucase_order"

                    ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn"

                    ng-readonly="show_invoice">

                <i class="fa fa-check fa_display"></i>Post Invoice

            </button>



            <button class="btn btn-default"

                    type="button"

                    ng-click="convert_post_invoice(rec2,rec, 1)"

                    ng-if="items.length > 0 && purchase_order_approval_req > 0"

                    ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn"

                    ng-readonly="show_invoice">

                <i class="fa fa-check fa_display"></i>Queue for Approval

            </button>



            <button class="btn btn-default "

                    type="button"

                    ng-click="reciveStock(rec2,rec,0,1)"

                    ng-if="items.length > 0 && !show_recieve_list && showReceiveStuff && allowreceive_prucase_order"

                    ng-readonly="show_stock"

                    ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn || disableReceiveBtn"

                    ng-class="">

                <i class="fa fa-check fa_display"></i>Receive Stock

            </button><!-- allocation_saved -->

            <button class="btn btn-default stockDispatchedBtn dont-click"

                    type="button"

                    ng-if="items.length > 0 && show_recieve_list && showReceiveStuff"

                    ng-readonly="show_stock">

                <i class="fa fa-check fa_display"></i> Stock Received

            </button>

            <button class="btn btn-delete active-btns dont-click"

                    ng-if="on_hold_order"

                    type="button">On Hold for Approval </button>



            <button class="btn pic_block btn-submit uom_check"

                    type="button"

                    ng-click="savePurchaseOrder(rec2,rec)"

                    ng-show="!on_hold_order && !check_srm_readonly">

                <i class="fa fa-check fa_display"></i> Save

            </button><!-- add_sublist -->

            <button class="btn btn-edit"

                    type="button"

                    ng-click="showEditForm();showEditorderForm(1)"

                    ng-if="allowedit_prucase_order"

                    ng-show="!on_hold_order && check_srm_readonly">

                <i class="fa fa-edit fa_display"></i> Edit

            </button>

            <button class="btn btn-cancel"

                    type="button"

                    ui-sref="{{btnCancelUrl}}"

                    ng-if="!purchaseOrderDeleteBtn">

                <i class="fa fa-undo fa_display"></i>Cancel

            </button>

            <button class="btn btn-cancel"

                    type="button"

                    ng-click="discardPurchaseOrder(rec2,rec)"

                    ng-if="purchaseOrderDeleteBtn && rec.order_code.length>0">

                <i class="fa fa-undo fa_display"></i>Cancel</button>

            <button class="btn btn-cancel"

                    type="button"

                    ui-sref="{{btnCancelUrl}}"

                    ng-if="purchaseOrderDeleteBtn && !(rec.order_code.length>0)">

                <i class="fa fa-undo fa_display"></i>Cancel</button>

        </div>

        <div class="pull-right"

             ng-show="!(rec.type == 3)">



            <button class="btn btn-default"

                ng-disabled="!check_srm_readonly"

                ng-click="GetApprovalStatus()"

                ng-if="items.length > 0 && purchase_order_approval_req > 0">Approval History</button>

     

            <button class="btn btn-default"

                    type="button"

                    ng-click="NavigateOrder(rec)">

                Navigate</button>

            <button class="btn btn-default"

                    type="button"

                    ng-if="items.length > 0 && showReceiveStuff"

                    ng-click="showInvoiceModal('receiptNote')">

                Goods Receipt Note

                <!--  && show_recieve_list && showReceiveStuff -->

            </button>

            <button class="btn btn-default"

                    type="button"

                    ng-click="showInvoiceModal('purchaseInvoice')">

                Purchase Invoice</button> <!-- Purchase -->

            <button class="btn btn-cancel"

                    type="button"

                    ui-sref="{{btnInvoiceCancelUrl}}">

                <i class="fa fa-undo fa_display"></i>Cancel

            </button>

        </div>

    </div>

=======
<div style="margin-bottom: 13px;">
    <div class="row" style="margin-bottom: 7px !important;">
        <div class="col-md-5">
            <button type="button" class="btn btn-default2" style="color:#2196F3;margin-left: 0;" ng-click="clearAndSearchItems()" ng-if="rec.type == 3 && submit_show_invoicee && !show_recieve_list" ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select Item</button>
            <!--  selectItem(0, 1,rec) -->
            <span ng-if="rec.type == 3 && rec.order_code" style="margin-left: 4px;" ng-controller="SetupController" ng-init="callbackAfterMigration = callbackAfterItemsMigration; callbackBeforeMigration = callbackBeforeItemsMigration" class="ib" ng-class="{'disable-el2':show_recieve_list || approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)}">
                <button type="button"
                        class="btn btn-default2"
                        ng-click="show_migrate_pop('Purchase-Orders-Items')"
                        style="color:#2196F3;margin-left: 0;">Upload Items</button>
                <div ng-include="'app/views/import_file.html'"></div>
            </span>
            <button type="button" class="btn btn-default2 dont-click" title="Stock Received" style="color:#2196F3" ng-click="clearAndSearchItems()" ng-if="rec.type == 3 && submit_show_invoicee && show_recieve_list" ng-disabled="show_recieve_list">Select Item</button>
            <!-- selectItem(0, 1,rec) -->
            <button class="btn btn-default2" type="button" style="color:#2196F3" ng-click="selectItem(1, 1,rec)" ng-if="rec.type == 3 && submit_show_invoicee" ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select G/L</button>
            <button class="btn btn-default2" type="button" style="color:#2196F3" title="Select Item Additional Cost" ng-click="selectItem(2, 1,rec)" ng-if="rec.type == 3 && submit_show_invoicee && !show_recieve_list && inventorySetup != 2" ng-disabled="approvals_lock_order == 1 || check_srm_readonly || !(rec.sell_to_cust_no.length>0)">Select Item Add. Cost</button>
            <button class="btn btn-default2" type="button" style="color:#2196F3" title="Select Item Additional Cost" ng-if="rec.type == 3 && submit_show_invoicee && show_recieve_list && inventorySetup != 2" ng-disabled="show_recieve_list">Select Item Add. Cost</button>
        </div>
        <!-- {{arr_vat_post_grp}}== {{order_posting_group_id}} -->
    </div>

    <table class="table table-striped table-bordered no-readonly">
        <thead ng-if="rec.type == 3 || rec.type == 2" class="fixit">
            <tr>
                <th style="width: 44px;">Type</th>
                <th style="width: 75px;">No.</th>
                <th style="width: 180px;">Description</th>
                <!-- width: 220px; -->
                <th class="text-right">Qty.</th>
                <th style="width: 62px;">U.O.M</th>
                <th style=" width:10% ">Warehouse</th>
                <!-- width:17%-->
                <th class="text-right">Unit Price</th>
                <th style="width: 7%">Discount Type</th>
                <th class="text-right">Discount</th>
                <th>VAT Rate</th>
                <th class="text-right">Original<br />Amount</th>
                <th class="text-right">Discount<br /> Amount </th>
                <th class="text-right"> Total<br /> Amount </th>
                <th class="text-right">VAT</th>
                <th style="width: 60px;">Action</th>
            </tr>
        </thead>
        <tbody ng-show="(rec.type == 3 || rec.type == 2)" class="fixit">
            <tr ng-repeat="(key,item) in items" ng-class="{ 't-partiallyallocated': (item.item_type == 0 && item.purchase_status==0 && item.remainig_qty > 0  && item.remainig_qty !=item.qty) || (item.item_type == 2 && item.purchase_status && item.remainingAdditionalCost > 0), 
                't-allocatedstock': (!show_recieve_list && item.item_type == 0 && showReceiveStuff && item.remainig_qty == 0) || (!show_recieve_list && item.item_type == 2 && item.purchase_status ==0 && item.remainingAdditionalCost == 0) ,
                't-stockreceived' : (show_recieve_list && item.item_type == 0 && showReceiveStuff) || (!(rec.type == 3) && item.item_type == 0)}">
                <td style="width: 44px;" ng-if="item.item_type == 0">
                    <select disabled="disabled" class="form-control" style="background: none; border: 0; padding: 0;">
                        <option>Item</option>
                    </select>
                </td>
                <td style="width: 44px;" ng-if="item.item_type == 1">
                    <select disabled="disabled" class="form-control" style="background: none; border: 0; padding: 0;">
                        <option>G/L<!-- Account --></option>
                    </select>
                </td>
                <td style="width: 44px;" ng-if="item.item_type == 2" title="Item Additional Cost">
                    <select disabled="disabled" class="form-control">
                        <option>IAC<!-- Add. Item <br> Cost -->
                        </option>
                    </select>
                </td>
                <td ng-if="item.item_type == 0 || item.item_type == 1" style="    width: 75px;" title="{{item.product_code}}">{{item.product_code}}
                    <a title="Landing Cost Setup" class="tooltips_clsss btn " ng-if="item.total_landing_cost>0" ng-click="show_landing_cost_detail(item.supplier_id,item.id)">
                        <i class="fa fa-eye"></i>
                    </a>
                </td>
                <td ng-if="item.item_type == 2" style="    width: 75px;" title="{{item.code}}">{{item.code}}</td>
                <td style="width: 180px;" title="{{item.product_name}}">
                    <!--width: 220px;  -->
                    <input type="text" class="form-control input_text" ng-model="item.product_name" ng-readonly="approvals_lock_order == 1 || check_srm_readonly || show_recieve_list">
                </td>
                <td class="text-right">
                    <!-- item.remainig_qty == 0 ||  -->
                    <input class="form-control input_text text-right" type="number" ng-readonly=" approvals_lock_order == 1 || check_srm_readonly || (show_recieve_list && item.item_type != 1)" ng-if="!check_srm_readonly" ng-change="!check_srm_readonly && check_min_max(item)"
                        ng-blur="!check_srm_readonly && UpdateQty(item)" ng-model="item.qty" min="0" oninput="validity.valid||(value='');" step="any">
                    <span ng-if="check_srm_readonly">{{item.qty | numberNoDecimalsIfZeroFilter:2:''}}</span>
                </td>
                <td style="width: 62px;">
                    <select class="form-control" ng-if="item.item_type == 0" ng-model="item.units" ng-change="!check_srm_readonly && check_min_max(item)" ng-options="opt as opt.name for opt in item.arr_units" ng-disabled="item.item_type == 0 || show_recieve_list  || approvals_lock_order == 1 || check_srm_readonly">
                        <option style="display:none" value=""></option>
                    </select>
                    <!-- +'('+opt.quantity+')' -->
                    <select class="form-control" required ng-model="item.units" ng-if="item.item_type == 1" ng-options="opt as opt.title for opt in gl_arr_units track by opt.id" ng-disabled="approvals_lock_order == 1 || check_srm_readonly">
                        <option value=""></option>
                        <!--  || show_recieve_list -->
                        <!--+'('+opt.quantity+')'-->
                    </select>
                    <span ng-if="item.item_type == 2">{{item.units}}</span>
                    <!-- <select class="form-control" disabled ng-if=" item.item_type == 2" ng-model="item.units" ng-options="opt as opt.title for opt in service_arr_units">
                        <option style="display:none" value=""></option>
                    </select> -->
                </td>
                <td style="width:10%" ng-if="item.item_type == 0">
                    <!-- width:17% -->
                    <!-- item.warehouse_id >0  ||  ng-attr-title bootstrap-tooltip ng-if="item.warehouses.name || 1"  overflow: visible;  class="tooltipa"-->
                    <!-- ng-if="item.stock_check == 1" -->
                    <select class="form-control " title="{{item.warehouses.name}} ({{item.warehouses.available_quantity}})" ng-disabled="(item.remainig_qty < item.qty) || approvals_lock_order == 1 || check_srm_readonly || show_recieve_list " ng-if="!check_srm_readonly" ng-model="item.warehouses"
                        ng-options="opt as opt.name +' ('+opt.available_quantity+')' for opt in item.arr_prod_warehouse">
                        <option style="display:none" value=""></option>
                    </select>
                    <span style="white-space: nowrap;" title="{{item.warehouses.name}} ({{item.warehouses.available_quantity}})" ng-if="check_srm_readonly && item.warehouses">{{item.warehouses.name}}
                        ({{item.warehouses.available_quantity}})</span>
                </td>
                <td style="width:10%" ng-if="item.item_type == 2">&nbsp;</td>
                <!-- width:17% -->
                <td style="width:10%" ng-if="item.item_type == 1">&nbsp;</td>
                <!-- width:17% -->
                <td class="text-right">
                    <input type="text" class="form-control input_text text-right" oninput="validateDecimalPoints(this, 5)" ng-readonly="approvals_lock_order == 1 || check_srm_readonly" ng-model="item.standard_price" ng-blur="!check_srm_readonly && UpdateStandardPrice(item)"
                        ng-change="checkItemPrice(item)" ng-if="!check_srm_readonly">
                    <!-- type="number" step="any" -->
                    <!-- <x-expression-eval ng-model="item.standard_price"
                                       step="any"
                                       ng-if="!check_srm_readonly"
                                       class="text-right"
                                       id="standard_price"
                                       x-value='item.standard_price'
                                       enable-percentage='1'
                                       title="Add expression * + - () / % and press tab to recalculate Unit Price"
                                       ng-blur="UpdateStandardPrice(item)"
                                       ng-change="checkItemPrice(item)">
                    </x-expression-eval> -->
                    <span ng-if="check_srm_readonly" title="{{item.standard_price | unitPriceFilter}}">{{item.standard_price | unitPriceFilter}}</span>
                </td>
                <td style="width: 7%">
                    <select class="form-control" ng-disabled="approvals_lock_order == 1 || check_srm_readonly" ng-if="item.isGLVat!=true" ng-model="item.discount_type_id" ng-change="onChangeDiscountType(item);UpdateStandardPrice(item,1);" ng-options="opt as opt.name for opt in arr_discount_type">
                        <option style="display:none" value=""></option>
                    </select>
                </td>
                <td class="text-right">
                    <div class="input-symbol">
                        <input type="number" min="0" step="0.01" class="form-control input_text text-right" ng-readonly="approvals_lock_order == 1 || check_srm_readonly" ng-change="onChangeDiscountType(item);" ng-blur="!check_srm_readonly && UpdateStandardPrice(item,1)" ng-pattern="/^[0-9]+(\.[0-9]{1,9})?$/"
                            ng-model="item.discount" ng-if="!check_srm_readonly && item.isGLVat!=true">
                    </div>
                    <span ng-if="item.discount_type_id.id && check_srm_readonly">{{item.discount | currency:""}}</span>
                    <span ng-show="item.discount_type_id.id == 'Percentage' && check_srm_readonly">&#37;</span>
                </td>
                <td title="{{item.vats.name}}">
                    <select class="form-control" ng-disabled="approvals_lock_order == 1 || check_srm_readonly" ng-model="item.vats" ng-if="item.isGLVat!=true" ng-options="opt as opt.name for opt in arrVATPostGrpPurchase  track by opt.id">
                        <!-- arr_vat -->
                        <option style="display:none" value=""></option>
                        <!-- arr_vat_post_grp[order_posting_group_id] -->
                    </select>
                </td>
                <td class="text-right" title="{{(item.isGLVat==true) ? 0 : item.standard_price * item.qty | currency:''}}">
                    {{(item.isGLVat==true) ? 0 : item.standard_price * item.qty | currency:"" }}</td>
                <!-- <td class="text-right" title="{{rowOriginalAmount(item) | currency:''}}">{{rowOriginalAmount(item) | currency:''}}</td>  -->
                <td class="text-right" title="{{rowDiscount(item)  | currency:'' }} "> {{rowDiscount(item) | currency:""}} </td>
                <td class="text-right" title="{{item.total_price = rowTotal(item) | currency:''}}">{{item.total_price = rowTotal(item) | currency:""}} </td>
                <td class="text-right" title=" {{item.vatPrice = rowVat(item) | currency:''}}"> {{item.vatPrice = rowVat(item) | currency:""}} </td>
                <!-- | number:2 &nbsp{{rec.currency_id.code}} -->
                <td ng-if="rec.type == 3 || rec.type == 2" style="    width: 60px;padding-right: 15px;padding-left: 2px;">
                    <span ng-if="item.item_type == 0">
                        <a title="{{ item.purchase_status == 1 ? 'Stock Allocation Completed' : 'Allocate Stock'}}"
                           ng-if="item.stock_check == 1"
                           ng-click="get_warehouse(item,rec,$index)"
                           ng-class="{'dont-click':!show_recieve_list_anchor}">
                            <i class="fa fa-cubes"
                               ng-class="{ 'in-comp-alloc' : item.purchase_status == 0 && item.remainig_qty > 0 && item.remainig_qty !=item.qty, 
                                            'comp-alloc': !show_recieve_list && showReceiveStuff && item.remainig_qty == 0 ,
                                            'item-dispatch' : (show_recieve_list && showReceiveStuff) || !(rec.type == 3)}"></i>
                            <!-- <i class="fa fa-cubes" 
                                ng-class="{ 'in-comp-alloc' : item.purchase_status == 0 && item.remainig_qty > 0, 
                                            'comp-alloc': item.purchase_status != 2 && item.remainig_qty == 0 ,
                                            'item-dispatch' : item.purchase_status == 2}"></i> -->
                        </a>
                        <!-- !check_srm_readonly || (InvoiceChk) &&  -->
                        <!-- {{item.remainig_qty}}/// {{item.qty}}  == {{item.qtyItemAllocated}} -->
                        <!-- <a ng-if="item.stock_check == 0 "
                           class="btn"
                           style="padding:3px 9px;"
                           ng-title="{{ item.sale_status && item.remainig_qty == 0 ? 'Stock Allocation Completed' : 'Allocate Stock'}}">
                            <i class="fa fa-stop"
                               style="position: relative;top: -2px; "
                               ng-class="{'item-dispatch' : item.purchase_status == 2 }"></i>                         
                        </a> -->
                    </span>
                    <span ng-if="item.item_type == 2">
                        <a class="btn"
                           ng-title="Item Additional Cost"
                           ng-click="getAdditionalItemCost(item,rec,$index)">
                            <i class="fa fa-plus-square-o"
                               style=" position: relative; top: -2px;"
                               ng-class="{'in-comp-alloc' : item.purchase_status && item.remainingAdditionalCost > 0, 
                                            'comp-alloc': !show_recieve_list && item.purchase_status ==0 && item.remainingAdditionalCost == 0,
                                            'item-dispatch' : show_recieve_list && showReceiveStuff && item.remainingAdditionalCost == 0}"></i>
                            <!-- 
                                <i class="fa fa-plus-square-o" 
                                ng-class="{'in-comp-alloc' : item.purchase_status && item.remainingAdditionalCost > 0, 
                                            'comp-alloc': item.purchase_status != 2 && item.remainingAdditionalCost == 0,
                                            'item-dispatch' : item.purchase_status == 2}"></i>
                             -->
                            <!-- {{item.remainingAdditionalCost}}=={{item.purchase_status}} -->
                        </a>
                    </span>
                    <a title="Delete" style="float: right;margin-right: 3px;" ng-if="!show_recieve_list || item.item_type == 1 || item.item_type == 2" ng-click="deleteOrderLine($index, item, items) " ng-class="{'dont-click':!show_recieve_list_anchor || approvals_lock_order == 1 || check_srm_readonly}">
                        <i class="fa fa-times"></i>
                    </a>
                </td>
            </tr>
            <tr ng-show="items.length ==0 ">
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td><input type="text" value="" readonly="readonly" class="form-control"></td>
                <td><input type="text" value="" readonly="readonly" class="form-control"></td>
                <td><input type="text" value="" readonly="readonly" class="form-control"></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
        </tbody>
    </table>
</div>
<!-- ng-class="{'col-md-2': (showVolumeWeight>0 && showReceiveStuff), 'col-md-3': !(showVolumeWeight>0 && showReceiveStuff)}"  -->
<div class="col-md-2" style="padding-left: 0;" title="Internal Note">
    <textarea rows="4" cols="30" maxlength="500" placeholder="Add Internal Note" class="form-control ng-pristine ng-valid ng-binding ng-valid-maxlength ng-touched" ng-model="rec.note" style="resize: none;height: 90px !important; background-color: #f4f7f7;    margin-bottom: 10px; color: green;"
        ng-change="showWordsLimits_invoice()" ng-disabled="check_srm_readonly && !check_pi_readonly"></textarea>
    <span class="word-counter">{{wordsLength}}/500</span>
</div>

<!-- ng-class="{'col-md-5': (showVolumeWeight>0 && showReceiveStuff), 'col-md-6': !(showVolumeWeight>0 && showReceiveStuff)}"  -->
<div class="col-md-5" style="padding-left: 0;" title="External Note">
    <textarea rows="4" cols="30" maxlength="500" placeholder="Add External Note" class="form-control ng-pristine ng-valid ng-binding ng-valid-maxlength ng-touched" ng-model="rec.externalnote" style="resize: none;height: 90px !important;    margin-bottom: 10px; color: red;"
        ng-change="showWordsLimits_invoice()" ng-disabled="check_srm_readonly && !check_pi_readonly"></textarea>
    <span class="word-counter">{{wordsLength}}/500</span>
</div>

<div class="col-md-2 no-padding" id="total-amout">

    <table class="invoice_total" ng-if="showVolumeWeight>0 && showReceiveStuff">
        <tr ng-if="volume !=0 && volume_permission>0">
            <td class="text-left">Total Volume</td>
            <td class="text-right">{{volume | quantityNum:2:''}} <span ng-if="volume_unit == 'cm3'">cm&sup3;</span><span ng-if="volume_unit != 'cm3'">{{volume_unit}}</span></td>
        </tr>
        <tr ng-if="weight !=0 && weight_permission>0">
            <td class="text-left">Total Weight</td>
            <td class="text-right">{{weight | quantityNum:2:''}} {{weightunit}}</td>
        </tr>
    </table>

    <table class="invoice_total" ng-if="defaultCurrencyCode != rec.currency_id.code">
        <tr>
            <td class="text-left ">Conversion Rate </td>
            <td class="text-right ">
                <input type="text " class="form-control " ng-disabled="check_srm_readonly " ng-model="rec.currency_rate" id="currency_rate " name="currency_rate">
            </td>
            <!--  && !check_pi_readonly -->
        </tr>
        <tr>
            <td class="text-left ">Amount Incl. VAT(LCY)</td>
            <td class="text-right ">{{onChangeCurrencyRate() | currency:""}}&nbsp;{{defaultCurrencyCode}}</td>
        </tr>
    </table>
    <div></div>
    <div class="clearfix ">&nbsp;</div>
</div>

<div class="col-md-3 no-padding " id="total-amout ">
    <div class="invoice_items-total no-margin ">
        <table class="invoice_total ">
            <tr ng-if="calcDiscount()>0">
                <td class="text-right">Discount</td>
                <td class="text-right">{{calcDiscount() | currency:""}}&nbsp;{{rec.currency_id.code}} </td>
            </tr>
            <tr>
                <td class="text-right">Amount</td>
                <td class="text-right"> {{netTotal() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>
            </tr>
            <tr>
                <td class="text-right">VAT</td>
                <td class="text-right">{{calcVat() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>
            </tr>
            <tr>
                <td class="text-right">Amount Incl. VAT</td>
                <td class="text-right">{{grandTotal() | currency:""}}&nbsp;{{rec.currency_id.code}}</td>
            </tr>
        </table>
    </div>
</div>

<div class="row">
    <div class="col-md-12" style="margin-top: 13px;">
        <div class="pull-left">

            <div ng-if="showReceiveStuff">
                <span class="margin-right"><i class="fa fa-circle" style="color:#ef7372;"></i> Partially Allocated </span>
                <span class="margin-right"><i class="fa fa-circle" style="color:#25b726;"></i> Allocated Stock </span>
                <span class="margin-right"><i class="fa fa-circle" style="color:#ffd351;"></i> Stock Recieved</span>
            </div>
            <!-- <div class="communication">
                <sidebar-notes ng-if="noRoleAssigned !=1" class="noselect"></sidebar-notes>
                <sidebar-email ng-if="noRoleAssigned !=1" class="noselect"></sidebar-email>
                <sidebar-attachment ng-if="noRoleAssigned !=1" class="noselect"></sidebar-attachment>
            </div> -->
        </div>

        <emailer ng-if="items.length > 0 && check_srm_readonly == true" x-hide-button="true" x-page-name="Purchases_ReceiptNote" x-parent-record-id="rec.id" x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}' x-to="supplierOrderEmail" x-to-array="rec.supplier_emails.Emails"
            x-modal-title="Goods Receipt Note No. {{rec.order_code}}" x-record-against="Supplier" x-pdf-generator="showInvoiceModal('receiptNote',1)" x-button-title="Receipt Note" x-data-obj="rec" x-pdf-ready="serviceVariables.generatedPDF" x-html-destroy="purchase_order_modal">
        </emailer>
        <!--  && rec.payable_bank -->

        <div class="pull-right" ng-show="(rec.type == 3) && submit_show_invoicee">
            <!-- <button class="btn btn-delete active-btns" type="button" 
                ng-click="deletePurchaseOrder()"
                ng-show="rec.id>0"> Delete </button> -->
            <button class="btn btn-default" ng-disabled="!check_srm_readonly" ng-click="GetApprovalStatus()" ng-if="items.length > 0 && purchase_order_approval_req > 0">Approval History</button>
            <emailer ng-if="rec.order_code && items.length > 0 && check_srm_readonly == true" x-hide-button="true" x-page-name="Purchases_PurchaseOrders" x-parent-record-id="rec.id" x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}' x-to="supplierOrderEmail"
                x-to-array="rec.supplier_emails.Emails" x-modal-title="{{rec.order_code}}" x-record-against="Supplier" x-pdf-generator="showInvoiceModal('purchaseOrder',1)" x-button-title="Purchase Order" x-data-obj="rec" x-pdf-ready="serviceVariables.generatedPDF"
                x-html-destroy="purchase_order_modal">
            </emailer>

            <emailer ng-if="items.length > 0 && check_srm_readonly == true" x-hide-button="true" x-page-name="Purchases_ReceiptNote" x-parent-record-id="rec.id" x-parent-record-name='{{rec.order_code + " - " + rec.sell_to_cust_name}}' x-to="supplierOrderEmail" x-to-array="rec.supplier_emails.Emails"
                x-modal-title="Goods Receipt Note No. {{rec.order_code}}" x-record-against="Supplier" x-pdf-generator="showInvoiceModal('receiptNote',1)" x-button-title="Receipt Note" x-data-obj="rec" x-pdf-ready="serviceVariables.generatedPDF" x-html-destroy="purchase_order_modal">
            </emailer>

            <button class="btn btn-default" type="button" ng-click="supplierPayment(rec)" ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn">Supplier Payment</button>

            <button class="btn btn-default" type="button" ng-click="showInvoiceModal('purchaseOrder')" ng-show="items.length > 0 && check_srm_readonly == true">
                Purchase Order
            </button>

            <button class="btn btn-default" type="button" ng-if="items.length > 0 && show_recieve_list && showReceiveStuff" ng-show="items.length > 0 && check_srm_readonly == true" ng-click="showInvoiceModal('receiptNote')">
                Goods Receipt Note
            </button>

            <!-- 
            <button class="btn btn-default"
                    ng-disabled="!check_srm_readonly"
                    ng-if="items.length > 0 && check_srm_readonly == true  && rec.payable_bank && showReceiveStuff"
                    ng-click="showInvoiceModal('purchaseDelivery');"
                    type="button">Delivery Note
            </button>      
            <emailer id="deliveryNoteEmailer"
                     ng-if="items.length > 0 && check_srm_readonly == true  && rec.payable_bank && showReceiveStuff"
                     x-hide-button="true"
                     x-page-name="Purchases_DeliveryNotes"
                     x-to="supplierOrderEmail"
                     x-to-array="rec.supplier_emails.Emails"
                     x-record-against="Customer"
                     x-modal-title="{{rec.order_code}}"
                     x-parent-record-id="rec.id"
                     x-parent-record-name='{{rec.order_code +
                    ((rec.order_code && rec.invoice_code)?"/":"") +
                    (rec.invoice_code?rec.invoice_code:"") + " - " + rec.bill_to_name}}'
                     x-pdf-generator="showInvoiceModal('purchaseDelivery', 1)"
                     x-data-obj="rec"
                     x-button-title="DN Confirmation"
                     x-pdf-ready="serviceVariables.generatedPDF">
            </emailer>
            <button class="btn btn-default"
                    ng-disabled="!check_srm_readonly"
                    ng-if="items.length > 0 && check_srm_readonly == true && rec.payable_bank && showReceiveStuff"
                    ng-click="showInvoiceModal('purchaseWarehouse');"
                    type="button">W/H Instructions </button>
            <emailer id="warehouseInstructionsEmailer"
                     ng-if="items.length > 0 && check_srm_readonly == true && rec.payable_bank && showReceiveStuff"
                     x-hide-button="true"
                     x-page-name="Purchases_WarehouseInstructions"
                     x-to="supplierOrderEmail"
                     x-to-array="allWarehouseEmails"
                     x-record-against="Warehouse"
                     x-modal-title="{{rec.order_code}}"
                     x-parent-record-id="rec.id"
                     x-parent-record-name='{{rec.order_code +((rec.order_code && rec.invoice_code)?"/":"") +
                    (rec.invoice_code?rfixSummernote3ec.invoice_code:"") + " - " + rec.bill_to_name}}'
                     x-pdf-generator="showInvoiceModal('purchaseWarehouse', 1)"
                     x-data-obj="rec"
                     x-button-title="W/H Instructions Confirmation"
                     x-pdf-ready="serviceVariables.generatedPDF">
            </emailer>
            <button class="btn btn-default" type="button"
                ng-if="items.length > 0"
                ng-disabled="check_srm_readonly"
                ng-click="showInvoiceModal('purchaseOrder')">
                View Order</button>
            <button class="btn btn-default"
                    type="button"
                    ng-click="convert_to_sales_order(rec2,rec);"
                    ng-if="items.length > 0 && rec.is_whole_seller > 0"
                    ng-disabled="!check_srm_readonly"
                    ng-readonly="show_invoice">
                <i class="fa fa-check fa_display"></i>Convert To SO
            </button> -->

            <button class="btn btn-default" type="button" ng-click="convert_post_invoice(rec2,rec)" ng-if="items.length > 0 && allowpost_prucase_order" ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn" ng-readonly="show_invoice">
                <i class="fa fa-check fa_display"></i>Post Invoice
            </button>

            <button class="btn btn-default" type="button" ng-click="convert_post_invoice(rec2,rec, 1)" ng-if="items.length > 0 && purchase_order_approval_req > 0" ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn" ng-readonly="show_invoice">
                <i class="fa fa-check fa_display"></i>Queue for Approval
            </button>

            <button class="btn btn-default " type="button" ng-click="reciveStock(rec2,rec,0,1)" ng-if="items.length > 0 && !show_recieve_list && showReceiveStuff && allowreceive_prucase_order" ng-readonly="show_stock" ng-disabled="on_hold_order || !check_srm_readonly || disablePostInvBtn || disableReceiveBtn"
                ng-class="">
                <i class="fa fa-check fa_display"></i>Receive Stock
            </button>

            <button class="btn btn-default stockDispatchedBtn dont-click" type="button" ng-if="items.length > 0 && show_recieve_list && showReceiveStuff" ng-readonly="show_stock">
                <i class="fa fa-check fa_display"></i> Stock Received
            </button>

            <button class="btn btn-delete active-btns dont-click" ng-if="on_hold_order" type="button">On Hold for Approval </button>

            <button class="btn pic_block btn-submit uom_check" type="button" ng-click="savePurchaseOrder(rec2,rec)" ng-show="!on_hold_order && !check_srm_readonly">
                <i class="fa fa-check fa_display"></i> Save
            </button>

            <button class="btn btn-edit" type="button" ng-click="showEditForm();showEditorderForm(1)" ng-if="allowedit_prucase_order" ng-show="!on_hold_order && check_srm_readonly">
                <i class="fa fa-edit fa_display"></i> Edit
            </button>

            <button class="btn btn-cancel" type="button" ui-sref="{{btnCancelUrl}}" ng-if="!purchaseOrderDeleteBtn">
                <i class="fa fa-undo fa_display"></i>Cancel
            </button>

            <button class="btn btn-cancel" type="button" ng-click="discardPurchaseOrder(rec2,rec)" ng-if="purchaseOrderDeleteBtn && rec.order_code.length>0">
                <i class="fa fa-undo fa_display"></i>Cancel</button>

            <button class="btn btn-cancel" type="button" ui-sref="{{btnCancelUrl}}" ng-if="purchaseOrderDeleteBtn && !(rec.order_code.length>0)">
                <i class="fa fa-undo fa_display"></i>Cancel</button>
        </div>

        <div class="pull-right" ng-show="!(rec.type == 3)">
            <button class="btn btn-default" ng-disabled="!check_srm_readonly" ng-click="GetApprovalStatus()" ng-if="items.length > 0 && purchase_order_approval_req > 0">Approval History</button>

            <button class="btn btn-default" type="button" ng-click="NavigateOrder(rec)">Navigate</button>

            <button class="btn btn-submit pic_block" type="button" ng-click="savePurchaseInvoice(rec)" ng-show="check_pi_readonly">
                <i class="fa fa-check fa_display"></i> Save
            </button>

            <button class="btn btn-edit" type="button" ng-click="showInvoiceEditForm(1)" ng-if="allowedit_prucase_order" ng-show="!check_pi_readonly">
                <i class="fa fa-edit fa_display"></i> Edit
            </button>
            <!-- // Update Purchase invoice         
                
            <button class="btn btn-submit pic_block" type="button" ng-click="save_sale_incoice(rec, rec2, 1);" ng-if="rec.type2 == 2" ng-show="check_si_readonly">Save</button>
            <button class="btn btn-edit" type="button" ng-click="showInvoiceEditForm();" ng-if="allowedit_sale_qoute_module && rec.type2 == 2" ng-show="!check_si_readonly">Edit </button>
            -->

            <button class="btn btn-default" type="button" ng-if="items.length > 0 && showReceiveStuff" ng-click="showInvoiceModal('receiptNote')">
                Goods Receipt Note<!--  && show_recieve_list && showReceiveStuff -->
            </button>

            <button class="btn btn-default" type="button" ng-click="showInvoiceModal('purchaseInvoice')">Purchase Invoice</button>

            <button class="btn btn-cancel" type="button" ui-sref="{{btnInvoiceCancelUrl}}">
                <i class="fa fa-undo fa_display"></i>Cancel
            </button>
        </div>
    </div>
>>>>>>> e31237e9eb73244117d4370f0a4bd96ad1c30564
</div>