
<div class="row">
  <div class="col-lg-4">
    <button class="btn btn_blue width_80" type="button" ng-click="show_mail();getUserInfo()"
    ><i class="fa fa-edit fa_display"></i> Mail</button>
  </div>
  <div class="col-lg-4"  ng-show="show_check_readonly_mail">
    <div class="form-group">
      <label class="col-lg-4 control-label">Account Type</label>
      <div class="col-lg-7">
        <select   ng-change="folder_id(account_type)" ng-model="account_type"
                      ng-options="opt as opt.username for opt in account_type_list" 
                      class=" form-control"   >
          <option style="display:none" value=""></option>
        </select>
      </div>
    </div>
  </div>
  <div class="col-lg-4"></div>
</div>
<div class="clearboth"></div>
<div  ng-show="display_mail_data"  >
  <div id="" role="main"  ng-init="getSmartContacts()"  >
    <!-- <toaster-container toaster-options="{'position-class': 'toast-top-right', 'close-button':true}"></toaster-container>
    <div ng-include="'app/views/_breadcrumb.html'" class="col-lg-12 remove-left-pad remove-right-pad"></div>--> 
    
    <!--<li class="list-group-item bg_white mail-item level1" ui-sref="app.folder({id:mail.info.id,type:'INBOX'})" style="text-align: left !important; padding-left: 10px !important; padding-right: 0px !important;" href="#/app/mail/5/INBOX/"> <span ng-class="{'unread': mail.counts['INBOX'] > 0, 'read': mail.counts['INBOX'] == 0}" class="unread">Inbox</span>&nbsp;<span ng-show="mail.counts['INBOX'] > 0" class="ng-binding">(1)</span></li>-->
    
    <input type="hidden" id="contacts123" value="{{contacts}}">
    <input type="hidden" id="edittobtn" value="">
    <input type="hidden" id="editccbtn" value="">
    <input type="hidden" id="editbccbtn" value="">
    <input type="hidden" id="cleartobtn" value="">
    <input type="hidden" id="clearccbtn" value="">
    <input type="hidden" id="clearbccbtn" value="">
    <div class="row" >
      <div class="col-lg-3 col-md-3 col-sm-12 col-sx-12" >
        <div class="panel panel-default" style="margin-bottom: 0px;">
          <div class="panel-heading">
            <h4 class="panel-title pull-left" style="text-transform: capitalize;">{{stateType}}</h4>
            <a href="javascript: void(0);" ng-click="folder();"><i class="fa fa-refresh email-refresh pull-right"></i></a>
            <div class="clearfix"></div>
          </div>
          <div class="panel-body no-padding">
            <div class="wrapper">
              <div id="scrollbar-two">
                <div class="scrollbar" style="height: 600px;">
                  <div class="track" style="height: 600px;">
                    <div class="thumb" style="top: 0px; height: 448.878px;">
                      <div class="end"> </div>
                    </div>
                  </div>
                </div>
                <div class="viewport" style="height: 570px;">
                  <div class="overview" style="top: 0px;">
                    <div class="featured-articles-container">
                      <div class="articles">
                        <div ng-repeat="email in folder track by $index" class="email_item">
                          <div class="pull-left inbox_icon"> <i class="fa fa-star pull-left yellow_star" ng-show="email.Flagged == 'F'" ng-click="changeFlag(email.Msgno, '\\Flagged', 'imap', 0);" id="{{'flags' + email.Msgno}}"></i> <i class="fa fa-star-o pull-left yellow_star" ng-show="email.Flagged == ''" ng-click="changeFlag(email.Msgno, '\\Flagged', 'imap', 1);" id="{{'flagu' + email.Msgno}}"></i> <i class="fa fa-mail-forward pull-left" ng-show="email.Forwarded == 'F' && email.Answered == ''"></i> <i class="fa fa-mail-reply pull-left" ng-show="email.Forwarded == '' && email.Answered == 'A'"></i> <i class="fa pull-left" ng-show="email.Forwarded == 'F' && email.Answered == 'A'"><img src="{{$rootScope.basePath + 'app/img/forward-reply-icon.png'}}"></i> <i class="fa pull-left" ng-show="email.Forwarded == '' && email.Answered == ''">&nbsp;&nbsp;</i> <i class="fa fa-paperclip pull-left" ng-show="email.Attachment == 'A'"></i> <i class="fa fa-paperclip pull-left inbox_grey" ng-show="email.Attachment == ''"></i> </div>
                          <a href="javascript: void(0);" ng-click="getFolderMessage(email.Msgno, 1);
                                                                                setMessageIndex($index);" ng-show="email.Recent == 'N' || email.Recent == 'R' || email.Unseen == 'U'" id="{{'msgu_' + email.Msgno}}">
                          <div ng-bind="email.subject" style="font-weight: bold; margin-top: 5px;"></div>
                          <div ng-repeat="sender in email.sender" style="font-weight: bold;">From: {{sender.personal}}</div>
                          </a> <a href="javascript: void(0);" ng-click="getFolderMessage(email.Msgno, 0);
                                                                                setMessageIndex($index);" ng-show="email.Recent == '' && email.Unseen == ''" id="{{'msgr_' + email.Msgno}}">
                          <div ng-bind="email.subject" style="margin-top: 5px;"></div>
                          <div ng-repeat="sender in email.sender">From: {{sender.personal}}</div>
                          </a> </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-9 col-md-9 col-sm-12 col-sx-12 remove-left-pad" ng-show="composemail">
        <div class="panel-heading bg-grey margin_bottom email_nav_pad">
          <h4 class="panel-title">
            <button class="btn btn-link no-padding-btn" type="button" ng-click="sendMail(mailAttachments);
                                                mailAttachments = [];">Send</button>
            <div class="fileUpload btn btn-link" style="padding: 2px 0px !important;">
              <form enctype="multipart/form-data" action="" method="post">
                <span class="ng-scope"><!--<i class="fa fa-paperclip" style="color: #88d2dd !important;"></i>-->Attachment</span>
                <input type="file" ngf-select="uploadFiles($file)" name="file[]" multiple accept="image/*" class="upload" ngf-max-height="1000" ngf-max-size="2MB" ngf-max-files="20">
                <input type="hidden" ng-model="mailAttachment.fileName" />
                <input type="hidden" ng-model="mailAttachment.newFileName" />
              </form>
            </div>
            <!--<button class="btn btn-link no-padding-btn" type="button" ng-click="saveMail(mailAttachments);
                                        mailAttachments = [];">SAVE DRAFT</button>-->
            <button class="btn btn-link no-padding-btn" type="button" ng-click="showDivCC();" ng-show="showCC">Cc</button>
            <button class="btn btn-link no-padding-btn" type="button" ng-click="showDivBCC();" ng-show="showBCC">Bcc</button>
          </h4>
        </div>
        <div class="panel" id="wrapper">
          <div class="" style="padding-bottom: 0px;">
            <div class="panel panel-default margin_bottom no-border" ng-show="showTo" ng-hide="!showTo">
              <div class="">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group no-margin" id="tosel">
                      <div class="demo" style="padding-top: 0px; padding-bottom: 0px; border-bottom: 0px !important;">
                        <input type="text" placeholder="" class="form-control sm-border-radius" ng-model="mail.mailTo" style="display: none;float: left;">
                        <div class="control-group">
                          <div style="float:left;color: #555 !important; padding-top: 10px; padding-left: 5px; width: 8%;">
                            <label style="color: #555 !important; font-size: 15px; font-weight: bold !important;">To:</label>
                          </div>
                          <select id="select-to" class="contacts" placeholder="" >
                          </select>
                        </div>
                      </div>
                      <script type="text/javascript">
                                                                        
                                                                         $(document).ready(function(){
                                                                             $timeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectTo = $('#select-to').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div id="'+item.email+'">' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });
                                                                        
                                                                        
                                                                        $("#tosel .selectize-input").on('change', function () {
                                                                            $("#select-to")[0].selectize.open();
                                                                        });

                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.clear();
//                                                                    $('#select-to').off('click');
//                                                                    $('#select-to').on('change');
//                                                                    selectizeTo.addOption([{"email": "ali434333@navsonsoftware.com", "first_name": "Ali Athar test111", "last_name": ""},{"email": "ali4343@navsonsoftware.com", "first_name": "Ali Athar test", "last_name": ""},]);
//                                                                    selectizeTo.addItem("ali434333@navsonsoftware.com");
//                                                                    selectizeTo.addItem("ali4343@navsonsoftware.com");


                                                                        });
                                                                        
                                                                      
                                                                            $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.removeItem($(this).attr('id'));

                                                                       });
                                                                        $('#edittobtn').on("click", function () {
                                                                            var toValue = $('#edittobtn').val();


                                                                        });
                                                                        $('#editccbtn').on("click", function () {
                                                                            var ccValue = $('#editccbtn').val();

                                                                        });
                                                                        $('#cleartobtn').on("click", function () {
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.clear();

                                                                        });

                                                                        // $("#select-to").val("hmmudassir22@test.com,faslfl@sdfdsf.com");
    }, 1000);                                                                
    });
                                                                    
                                                                       </script> 
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel panel-default margin_bottom no-border" ng-show="!showCC && showCC1">
              <div class="">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group no-margin" id="ccsel">
                      <textarea placeholder="" class="form-control sm-border-radius custom_textarea" ng-model="mail.mailCC[0]" style="resize: none; display: none;" rows="1"></textarea>
                      <div class="demo" style="padding-top: 0px; padding-bottom: 0px; border-bottom: 0px !important;">
                        <div class="control-group">
                          <div style="float:left;color: #555 !important; padding-top: 10px; padding-left: 5px; width: 8%;">
                            <label style="color: #555 !important; font-size: 15px; font-weight: bold !important;">Cc:</label>
                          </div>
                          <select id="select-cc" class="contacts" placeholder="" ng-model="mail.mailCC[0]">
                          </select>
                        </div>
                      </div>
                      <script type="text/javascript">
                                             $(document).ready(function(){
                                                                             $timeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectCC = $('#select-cc').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div>' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });
                                                                        $("#ccsel .selectize-input").on('change', function () {
                                                                            $("#select-cc")[0].selectize.open();
                                                                        });
                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.clear();

                                                                        });
                                                                        $('#clearccbtn').on("click", function () {
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.clear();

                                                                        });
                                                                          $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.removeItem($(this).attr('id'));
                                                                       });
                                                                     }, 1000);                                                                
    });</script> 
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel panel-default margin_bottom no-border" ng-show="!showBCC && showBCC1">
              <div class="">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group no-margin" id="bccsel">
                      <textarea placeholder="" class="form-control sm-border-radius custom_textarea" ng-model="mail.mailBCC[0]" style="resize: none; display: none;" rows="1"></textarea>
                      <div class="demo" style="padding-top: 0px; padding-bottom: 0px; border-bottom: 0px !important;">
                        <div class="control-group">
                          <div style="float:left;color: #555 !important; padding-top: 10px; padding-left: 5px; width: 8%;">
                            <label style="color: #555 !important; font-size: 15px; font-weight: bold !important;">Bcc:</label>
                          </div>
                          <select id="select-bcc" class="contacts" placeholder="" ng-model="mail.mailBCC[0]">
                          </select>
                        </div>
                      </div>
                      <script type="text/javascript">
                                                                    $(document).ready(function(){
                                                                             $timeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectBCC = $('#select-bcc').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div>' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });
                                                                        $("#bccsel .selectize-input").on('change', function () {
                                                                            $("#select-bcc")[0].selectize.open();
                                                                        });
                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.clear();
                                                                        });
                                                                        $('#clearbccbtn').on("click", function () {
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.clear();

                                                                        });
                                                                          $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.removeItem($(this).attr('id'));
                                                                       });
                                                                     }, 1000);                                                                
    });</script> 
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel panel-default margin_bottom no-border" ng-show="showSubject">
              <div class="">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group no-margin">
                      <div style="float:left;color: #555 !important; padding-top: 10px; padding-left: 5px;">
                        <label style="color: #555 !important; font-size: 15px; font-weight: bold !important;">Subject:</label>
                      </div>
                      <input type="text" placeholder="" class="form-control sm-border-radius" ng-model="mail.mailSubject" ng-click="checkCCAndBCC();" style="width: 92%; float: right;"/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="panel panel-default margin_bottom no-border no-height">
              <div style="float:left;color: #555 !important; padding-top: 10px; padding-left: 5px;">
                <label style="color: #555 !important; font-size: 15px; font-weight: bold !important;">Attachment(s):</label>
              </div>
              <div class="row" style="float: right; width: 88%; font-size: 14px; line-height: 12px; padding: 10px 0px; border-radius: 2px;">
                <div class="col-md-12" ng-show="mailAttachments.length > 0" style="padding-left: 0px;">
                  <div class="form-group no-margin"> <span ng-repeat="attachment in mailAttachments" style="margin-left: 5px;" class="tag"> <a target="_blank" href="{{$rootScope.basePath}}upload/mail_attachments/{{attachment.newFileName}}">{{attachment.fileName}}<!--<em style="font-size: 30px !important;" class="fa fa-file-image-o"></em>--></a> </span> </div>
                </div>
              </div>
            </div>
          </div>
          <div class="" style="padding-top: 0px;" id="editorpanel">
            <textarea placeholder="" class="form-control mceEditor1" id="myarea" style="height: 350px !important; width: 100%;"></textarea>
            <script type="text/javascript">
                                                $timeout(function () {
                                                    tinyMCE.init({
                                                        // General options
                                                        mode: "specific_textareas",
                                                        editor_selector: "mceEditor1",
                                                        theme: "advanced",
                                                        //  plugins: "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave",
                                                        plugins: "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave",
                                                        // Theme options
                                                        paste_data_images: true,
                                                        paste_as_text: false,
                                                        relative_urls: false,
                                                        remove_script_host: false,
                                                        document_base_url: "<?=WEB_PATH?>/",
                                                        theme_advanced_buttons1: "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect,bullist,numlist,cut,copy,paste,link,unlink,forecolor,backcolor|,undo,redo,",
                                                        //theme_advanced_buttons2: "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
                                                        theme_advanced_buttons2: "",
                                                        theme_advanced_buttons3: "",
                                                        theme_advanced_buttons4: "",
                                                        //                        theme_advanced_buttons2: ",pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,",
                                                        //                        theme_advanced_buttons3: "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
                                                        //                        theme_advanced_buttons4: "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak,restoredraft",
                                                        theme_advanced_toolbar_location: "top",
                                                        theme_advanced_toolbar_align: "left",
                                                        //theme_advanced_statusbar_location: "bottom",
                                                        theme_advanced_resizing: true,
                                                        // Example content CSS (should be your site CSS)
                                                        content_css: "css/content.css",
                                                        // Drop lists for link/image/media/template dialogs
                                                        template_external_list_url: "lists/template_list.js",
                                                        external_link_list_url: "lists/link_list.js",
                                                        external_image_list_url: "lists/image_list.js",
                                                        media_external_list_url: "lists/media_list.js",
                                                        // Style formats
                                                        /*
                                                         formats : {
                                                         alignleft : {selector : 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img', classes : 'left'},
                                                         aligncenter : {selector : 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img', classes : 'center'}
                                                         },
                                                         style_formats : [
                                                         {title : 'Test 1', selector : 'img', class : 'tablerow1'},
                                                         {title : 'Test 2', selector : 'img', class : 'classTest'}
                                                         ],
                                                         */
                                                        style_formats_merge: true,
                                                        style_formats: [
                                                            {
                                                                title: 'Image Right',
                                                                selector: 'img',
                                                                classes: 'classTest'
                                                            },
                                                            {
                                                                title: 'Image Left',
                                                                selector: 'img',
                                                                classes: 'classLeft'
                                                            }
                                                        ],
                                                        // Replace values for the template plugin
                                                        template_replace_values: {
                                                            username: "Some User",
                                                            staffid: "991234"
                                                        }
                                                    });
                                                }, 50);</script>
            <div class="clearfix"></div>
            <div class="vertical_space"></div>
            <div class="row">
              <div class="col-lg-12">
                <div class="pull-left" style="margin-bottom: 5px; padding: 0px; margin-bottom: 0px;"> </div>
                <div class="pull-right">
                  <button class="btn btn_blue width_80" type="button" ng-click="sendMail(mailAttachments); mailAttachments = [];"><!--<i class="fa fa-check"></i>--> Send</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-9 col-md-9 col-sm-12 col-sx-12 remove-left-pad" ng-init="getMailFolders();" ng-show="defaultmail">
        <div class="panel panel-default" style="margin-bottom: 0px;">
          <div class="panel-heading bg-grey margin_bottom" ><!--ng-click="newMail()"-->
            <h4 class="panel-title">
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" id="newmailbtn" title="" ng-click="composeMail();">New</button>
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" title="" ng-show="readmail" ng-click="reply();
                                                    getFolderMessageByParams('Rep: ');">Reply</button>
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" title="" ng-show="readmail && replyall" ng-click="replyAll();
                                                    getFolderMessageByParams('Rep All: ');">Reply All</button>
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" title="" ng-show="readmail" ng-click="forward();
                                                    getFolderMessageByParams('Fwd: ');">Forward</button>
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" title="" ng-show="readmail" ng-click="moveMessage('INBOX.Trash');">Delete</button>
              <div class="btn-group open" ng-show="readmail">
                <button aria-expanded="true" aria-haspopup="true" data-toggle="dropdown" type="button" class="btn btn-link no-padding-btn dropdown-toggle"> Move To <span class="caret"></span> </button>
                <ul class="dropdown-menu" style="margin-top:12px;margin-left: 14px;">
                  <li ng-repeat="(key, value) in mailFolders"><a href="javascript: void(0);" ng-click="moveMessage(key);" ng-bind="value"></a></li>
                </ul>
              </div>
              <button class="btn btn-link no-padding-btn" type="button" data-original-title="" title="" ng-show="readmail" ng-click="printMessage();">Print</button>
              <div class="col-md-1 no-padding pull-right" style="text-align: right; margin-top: -5px; margin-left: 5px;">
                <button ui-sref="app.search({id:$stateParams.id,keyword:searchKeyword})" class="btn btn_blue width_80" style="padding: 2px 5px; font-size: 13px;"><!--<i class="fa fa-search" style="color: #FFF !important; font-size: 11px !important;"></i>-->Search</button>
              </div>
              <div class="col-md-2 no-padding pull-right">
                <input type="text" placeholder="Search" id="search" class="form-control search_f" style="line-height: 26px;" ng-model="searchKeyword" />
              </div>
            </h4>
          </div>
          <div class="panel panel-default" style="margin-bottom: 0px;">
            <div class="panel-body" style="height: 590px; padding: 15px 15px 0px 15px;">
              <div ng-show="readmail" >
                <div class="bg-grey" id="mailheader">
                  <p ng-bind="header.subject" style="margin: 0px; padding: 0px 5px; font-weight: bold;"></p>
                  <strong ng-repeat="sender in header.sender" ng-bind="sender.personal" style="margin: 0px; padding:  0px 5px;"></strong>
                  <p ng-show="header.date" style="margin: 0px; padding: 0px 5px;"><strong style="width: 30px; font-weight: bold;">Sent:</strong> {{header.date}}</p>
                  <p style="margin: 0px; padding: 0px 5px;"><strong style="width: 30px; font-weight: bold;" ng-show="header.to.length > 0">To:</strong> <span ng-repeat="to in header.to">{{to.personal + '<' + to.to + '>'}}&nbsp;</span></p>
                  <p style="margin: 0px; padding: 0px 5px;"><strong style="width: 30px; font-weight: bold;" ng-show="header.cc.length > 0">Cc:</strong> <span ng-repeat="cc in header.cc">{{cc.personal + '<' + cc.cc + '>'}};&nbsp;</span></p>
                  <div ng-show="attachments" style="margin: 0px; padding: 0px 5px;"> <strong style="width: 30px; font-weight: bold;" ng-show="attachments.length > 0">Attachment(s):</strong>
                    <div style="" ng-repeat="attachment in attachments"><a href="javascipt: void(0);" ng-click="downloadAttachment(attachment.mailno, attachment.ano, attachment.enc, attachment.method, attachment.name, attachment.partNum, attachment.subtype);">{{attachment.name}}</a></div>
                  </div>
                </div>
                <div class="clearfix"></div>
                <br/>
                <iframe id="iframe1" frameborder="0" style="width: 100%; height: 470px;"> </iframe>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style type="text/css">
ol.breadcrumb {
	margin-bottom: 5px !important;
}
.dropdown-menu > li > a, li.active span {
	text-transform: capitalize;
}
.selectize-control.contacts .selectize-input > div {
	padding: 1px 10px;
	font-size: 13px;
	font-weight: normal;
	-webkit-font-smoothing: auto;
	color: #FFF;
	background: #88d2dd;
	border: 1px solid #88d2dd;
	-webkit-border-radius: 999px;
	-moz-border-radius: 999px;
	border-radius: 999px;
}
.selectize-control.contacts .selectize-input > div.active {
	background: #88d2dd;
	border-color: #88d2dd;
}
.selectize-control.contacts .selectize-input > div .email {
	opacity: 0.8;
}
.selectize-control.contacts .selectize-input > div .name + .email {
	margin-left: 5px;
}
.selectize-control.contacts .selectize-input > div .email:before {
	content: '<';
}
.selectize-control.contacts .selectize-input > div .email:after {
	content: '>';
}
.selectize-control.contacts .selectize-dropdown .caption {
	font-size: 12px;
	display: block;
	color: #000;
}
.selectize-dropdown-content .label {
	color: #000 !important;
	float: left;
	line-height: 18px !important;
}
.selectize-dropdown-content .caption {
	float: left;
	margin-left: 3px;
}
.selectize-input span {
	color: #000 !important;
}
.selectize-input {
	overflow-y: scroll !important;
	height: 35px !important;
}
.demo select, .demo input, .demo .selectize-control {
	width: 92%;
	float: left;
	text-align: left;
}
</style>
