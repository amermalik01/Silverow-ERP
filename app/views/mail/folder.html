
<div id="" role="main" ng-controller="MailController" ng-init="getUserInfo();  folder(); getSmartContacts();">
  <toaster-container toaster-options="{'position-class': 'toast-top-right', 'close-button':true}"></toaster-container>
  <style type="text/css">

  .sender-name::first-letter {
    color: red !important;
  }

        ol.breadcrumb{margin-bottom: 5px !important;}
        .dropdown-menu > li > a, li.active span{text-transform: capitalize; }
        .selectize-control.multi .selectize-input [data-value] {
          box-shadow: none;
          border-radius: 1px;
          font-size: 10px;
          text-shadow: none;
          background: #f1f1f1;
          border: 0px;
        }
        .selectize-control.contacts .selectize-input > div.active {
            background: #88d2dd;
            border-color: #88d2dd;
        }
        .selectize-control.contacts .selectize-input > div .email {
            opacity: 0.8;
        }
        .selectize-control.contacts .selectize-input > div .name + .email {
            margin-left: 5px;
        }
        .selectize-control.contacts .selectize-input > div .email:before {
            content: '<';
        }
        .selectize-control.contacts .selectize-input > div .email:after {
            content: '>';
        }
        .selectize-control.contacts .selectize-dropdown .caption {
            font-size: 12px;
            display: block;
            color: #000;
        }
        .selectize-dropdown-content .label{color: #000 !important; float: left; line-height: 18px !important;}
        .selectize-dropdown-content .caption{float: left; margin-left: 3px;}
        .selectize-input span{color: #000 !important;}
        .selectize-input{
          box-shadow: none;
          border-radius: 2px;
          border: 1px solid transparent;
          height: 29px;}

          .selectize-input:hover {
            border: 1px solid #3693cf;
          }
        .demo select, .demo input, .demo .selectize-control{width: 92%; float: left; text-align: left;}
        .mceLayout {
          margin-top: 27px !important;
margin-left: 23px !important;
width: 96% !important;
        }
    </style>

  <input type="hidden" id="contacts123" value="{{contacts}}">
  <input type="hidden" id="edittobtn" value="">
  <input type="hidden" id="editccbtn" value="">
  <input type="hidden" id="editbccbtn" value="">
  <input type="hidden" id="cleartobtn" value="">
  <input type="hidden" id="clearccbtn" value="">
  <input type="hidden" id="clearbccbtn" value="">

  <div ng-include="'app/views/_breadcrumb.html'" class="col-lg-12 remove-left-pad remove-right-pad"></div>

  <divng-controller="MailAttachmentController">
    <div class="col-md-3 no-padding">
      <div class="d-wi e-wi no-padding">
        <div class="hb">
          <!-- <a href="javascript: void(0);" ng-click="folder();"><i class="fa fa-refresh email-refresh pull-right"></i></a> -->
          <h5 style="padding: 14px 0px 0px 14px;font-size: 18px;font-weight: 600;">
            <i class="fa fa-envelope-o" aria-hidden="true" style="margin-right: 6px;color: #5a5a5a;"></i> Inbox</h5>
            <a class=" compose-mail " data-toggle="collapse" data-target="#search" title="Search" style="right: 60px;background: inherit;color: #888888;"><i class="fa fa-search" aria-hidden="true"></i></a>
            <a class=" compose-mail "ng-click="composeMail();" title="Compose"><i class="fa fa-pencil" aria-hidden="true"></i></a>

            <div id="search" class="collapse e-as">
              <input type="text" placeholder="From / To /Subject" id="search" class="form-control search_e pull-left "  ng-model="searchKeyword" />
              <button ui-sref="app.search({id:$stateParams.id,keyword:searchKeyword})" class="i-89" title="Search"><i class="fa fa-search" aria-hidden="true" style=""></i></button>
              <input type="text" placeholder="From"  class="form-control search_e pull-left "/>
              <input type="text" placeholder="To"  class="form-control search_e pull-left "/>
              <input type="text" placeholder="Subject"  class="form-control search_e pull-left "/>
            </div>

        </div>
      </li>
        <div>
          <div>
            <div >
              <div>
                <div>
                  <div>
                    <div style="margin-top: 12px;" class="message-scroll">
                      <div ng-repeat="email in folder track by $index" class="email_item fadeIn animated">

                        <div>
                          <div class="sss" style="display: block;height: 45px;float: left;margin-right: 11px;margin-top: 12px;">
                          <i class="material-icons f-1" style="font-size: 29px;color: #e4e4e4;">&#xE853;</i>
                                                    </div>
                          <a href="javascript: void(0);"  ng-click="getFolderMessage(email.Msgno, 1); setMessageIndex($index);" ng-show="email.Recent == 'N' || email.Recent == 'R' || email.Unseen == 'U'" id="{{'msgu_' + email.Msgno}}">
                            <b ng-repeat="sender in email.sender" class="sender-name">{{sender.personal}}</b>
                            <div ng-bind="email.subject" class="sender-subject"></div>
                            <div class="show-gh">
                            <div ng-show="email.MailDate" class="s-a" title="{{email.MailDate}}">{{email.MailDate}}</div>
                            </div>
                          </a>

                          <a href="javascript: void(0);" ng-click="getFolderMessage(email.Msgno, 0); setMessageIndex($index);" ng-show="email.Recent == '' && email.Unseen == ''" id="{{'msgr_' + email.Msgno}}">
                          <b ng-repeat="sender in email.sender" class="sender-name">{{sender.personal}}</b>
                          <div ng-bind="email.subject" class="sender-subject"></div>
                          </a>
                          <div class="show-gh">
                          <div ng-show="email.MailDate" class="s-a">{{email.MailDate}}</div>
                          </div>
                      </div>

                        <div class="message-icons animated fadeInRight">
                          <i class="fa fa-paperclip" title="Contains Attachment" ng-show="email.Attachment == 'A'"></i>
                          <i class="fa fa-star" title="Favourite "ng-show="email.Flagged == 'F'" ng-click="changeFlag(email.Msgno, '\\Flagged', 'imap', 0);" id="{{'flags' + email.Msgno}}"></i>
                          <i class="fa fa-star-o  " title="Add to Favourites" ng-show="email.Flagged == ''" ng-click="changeFlag(email.Msgno, '\\Flagged', 'imap', 1);" id="{{'flagu' + email.Msgno}}"></i>
                          <i class="fa fa-mail-forward" title="Forwaded Email" ng-show="email.Forwarded == 'F' && email.Answered == ''"></i>
                          <i class="fa fa-mail-reply " ng-show="email.Forwarded == '' && email.Answered == 'A'" title="Replied"></i>
                          <i class="fa" ng-show="email.Forwarded == 'F' && email.Answered == 'A'"><img src="{{$rootScope.basePath + 'app/img/forward-reply-icon.png'}}">
                          </i>

                       </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-9">

      <div class="d-wi no-padding d-wf">
        <div class="hb" style="    margin-bottom: 11px;">
          <h5 style="padding: 14px 0px 0px 14px;font-size: 18px;font-weight: 600;">New Message</h5>
          <div class="action-btns">
          <a class="compose-mail pull-right" type="button" ng-click="sendMail(mailAttachments);mailAttachments = [];" title="Send"><i class="fa fa-paper-plane" aria-hidden="true"></i></a>
          <!--<button class="btn btn-link no-padding-btn" type="button" ng-click="saveMail(mailAttachments);
                                        mailAttachments = [];">SAVE DRAFT</button>-->
          <button class="btn btn-link" type="button" ng-click="showDivCC();" ng-show="showCC">Cc</button>
          <button class="btn btn-link" type="button" ng-click="showDivBCC();" ng-show="showBCC">Bcc</button>
        </div>

      </div>

      <div>
        <div>
          <div ng-hide="!showTo">
            <div>
              <div>
                <div class="col-md-12" style="    border-bottom: 1px solid #e0e0e0;">
                  <div class="form-group no-margin" id="tosel">
                    <div>
                      <!-- <input type="text" placeholder="To" class="form-control sm-border-radius" ng-model="mail.mailTo" style="display: none;"> -->
                        <div class="col-md-1 control-label2">To:</div> <div class="col-md-11">
                          <select id="select-to" class="contacts" placeholder=""><option value="">Recipients</option></select></div>
                    </div>
                    </script>
                    <script type="text/javascript">
                    $("b.sender-name").click(function() {
                      $("b.sender-name").removeClass('selected2');
                        $(this).addClass('selected2');
                    });


                                                                         $(document).ready(function(){
                                                                             setTimeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectTo = $('#select-to').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div id="'+item.email+'">' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });


                                                                        $("#tosel .selectize-input").on('change', function () {
                                                                            $("#select-to")[0].selectize.open();
                                                                        });

                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.clear();
//                                                                    $('#select-to').off('click');
//                                                                    $('#select-to').on('change');
//                                                                    selectizeTo.addOption([{"email": "ali434333@navsonsoftware.com", "first_name": "Ali Athar test111", "last_name": ""},{"email": "ali4343@navsonsoftware.com", "first_name": "Ali Athar test", "last_name": ""},]);
//                                                                    selectizeTo.addItem("ali434333@navsonsoftware.com");
//                                                                    selectizeTo.addItem("ali4343@navsonsoftware.com");


                                                                        });


                                                                            $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.removeItem($(this).attr('id'));
                                                                       });
                                                                        $('#edittobtn').on("click", function () {
                                                                            var toValue = $('#edittobtn').val();


                                                                        });
                                                                        $('#editccbtn').on("click", function () {
                                                                            var ccValue = $('#editccbtn').val();

                                                                        });
                                                                        $('#cleartobtn').on("click", function () {
                                                                            var selectizeTo = $selectTo[0].selectize;
                                                                            selectizeTo.clear();

                                                                        });

                                                                        // $("#select-to").val("hmmudassir22@test.com,faslfl@sdfdsf.com");
    }, 1000);
    });

                                                                       </script>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div ng-show="!showCC && showCC1">
            <div>
              <div>
                <div class="col-md-12" style="    border-bottom: 1px solid #e0e0e0;">
                  <div class="form-group" id="ccsel">
                    <!-- <textarea placeholder="" class="form-control" ng-model="mail.mailCC[0]" style="resize: none; display: none;" rows="1"></textarea> -->
                    <div>
                      <div class="control-group">
                        <div class="col-md-1 control-label2">Cc:</div>
                        <div class="col-md-11"><select id="select-cc" class="contacts" placeholder="" ng-model="mail.mailCC[0]"><option value="">Recipients</option></select></select></div>
                      </div>
                    </div>
                    <script type="text/javascript">
                                             $(document).ready(function(){
                                                                             setTimeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectCC = $('#select-cc').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div>' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });
                                                                        $("#ccsel .selectize-input").on('change', function () {
                                                                            $("#select-cc")[0].selectize.open();
                                                                        });
                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.clear();

                                                                        });
                                                                        $('#clearccbtn').on("click", function () {
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.clear();

                                                                        });
                                                                          $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeCC = $selectCC[0].selectize;
                                                                            selectizeCC.removeItem($(this).attr('id'));
                                                                       });
                                                                     }, 1000);
    });</script>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div ng-show="!showBCC && showBCC1">
            <div>
              <div>
                <div class="col-md-12" style="    border-bottom: 1px solid #e0e0e0;"  >
                  <div class="form-group" id="bccsel">
                    <!-- <textarea placeholder="" class="form-control sm-border-radius custom_textarea" ng-model="mail.mailBCC[0]" style="resize: none; display: none;" rows="1"></textarea> -->
                    <div>
                        <div class="col-md-1 control-label2">Bcc:</div>
                        <div class="col-md-11"><select id="select-bcc"  class="contacts" placeholder="" ng-model="mail.mailBCC[0]"><option value="">Recipients</option></select></select></div>
                    </div>
                    <script type="text/javascript">
                                                                    $(document).ready(function(){
                                                                             setTimeout(function () {
                                                                        var REGEX_EMAIL = '([a-z0-9!#$%&\'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&\'*+/=?^_`{|}~-]+)*@' +
                                                                                '(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)';
                                                                        var formatName = function (item) {
                                                                            return $.trim((item.first_name || '') + ' ' + (item.last_name || ''));
                                                                        };
                                                                        var $selectBCC = $('#select-bcc').selectize({
                                                                            persist: false,
                                                                            maxItems: null,
                                                                            openOnFocus: false,
                                                                            valueField: 'email',
                                                                            labelField: 'name',
                                                                            searchField: ['first_name', 'last_name', 'email'],
                                                                            sortField: [
                                                                                {field: 'first_name', direction: 'asc'},
                                                                                {field: 'last_name', direction: 'asc'}
                                                                            ],
                                                                            options: $.parseJSON($('#contacts123').val()), //$('[ng-controller="MailController"]').scope().contacts,
                                                                            render: {
                                                                                item: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    return '<div>' +
                                                                                            (name ? '<span class="name">' + escape(name) + '</span>' : '') +
                                                                                            (item.email ? '<span class="email">' + escape(item.email) + '</span>&nbsp;&nbsp;<span class="crossbtn" id="' + escape(item.email) + '" style="padding: 5px; border-radius: 2px;">x</span>' : '') +
                                                                                            '</div>';
                                                                                },
                                                                                option: function (item, escape) {
                                                                                    var name = formatName(item);
                                                                                    var label = name || item.email;
                                                                                    var caption = name ? item.email : null;
                                                                                    return '<div>' +
                                                                                            '<span class="label">' + escape(label) + '</span>' +
                                                                                            (caption ? '<span class="caption">' + escape(caption) + '</span>' : '') +
                                                                                            '</div>';
                                                                                }
                                                                            },
                                                                            createFilter: function (input) {
                                                                                var regexpA = new RegExp('^' + REGEX_EMAIL + '$', 'i');
                                                                                var regexpB = new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i');
                                                                                return regexpA.test(input) || regexpB.test(input);
                                                                            },
                                                                            create: function (input) {
                                                                                if ((new RegExp('^' + REGEX_EMAIL + '$', 'i')).test(input)) {
                                                                                    return {email: input};
                                                                                }
                                                                                var match = input.match(new RegExp('^([^<]*)\<' + REGEX_EMAIL + '\>$', 'i'));
                                                                                if (match) {
                                                                                    var name = $.trim(match[1]);
                                                                                    var pos_space = name.indexOf(' ');
                                                                                    var first_name = name.substring(0, pos_space);
                                                                                    var last_name = name.substring(pos_space + 1);
                                                                                    return {
                                                                                        email: match[2],
                                                                                        first_name: first_name,
                                                                                        last_name: last_name
                                                                                    };
                                                                                }
                                                                                alert('Invalid email address.');
                                                                                return false;
                                                                            }
                                                                        });
                                                                        $("#bccsel .selectize-input").on('change', function () {
                                                                            $("#select-bcc")[0].selectize.open();
                                                                        });
                                                                        $("#newmailbtn").on("click", function () {
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.clear();
                                                                        });
                                                                        $('#clearbccbtn').on("click", function () {
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.clear();

                                                                        });
                                                                          $(document).on("click",".crossbtn", function (event) {
                                                                                event.preventDefault();
                                                                            var selectizeBCC = $selectBCC[0].selectize;
                                                                            selectizeBCC.removeItem($(this).attr('id'));
                                                                       });
                                                                     }, 1000);});</script>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div ng-show="showSubject">
            <div >
              <div>
                <div class="col-md-12" style="    border-bottom: 1px solid #e0e0e0;">
                    <div class="col-md-1 control-label2">Subject:</div>
                    <div class="col-md-11"><input type="text" class="r-p"  ng-model="mail.mailSubject" ng-click="checkCCAndBCC();"  placeholder="Write your Subject"/></div>
                </div>
              </div>
            </div>
          </div>
          <div>
            <div>
              <label style="margin-top: 16px;margin-left: 28px;font-weight: 600 !important;">Attachment(s):</label>
              <div class="fileUpload btn btn-link" style="font-size:12px;">
                <form enctype="multipart/form-data" action="" method="post">
                  <span class="ng-scope">Attach File</span>
                  <input type="file" ngf-select="uploadFiles($file)" name="file[]" multiple accept="image/*" class="upload" ngf-max-height="1000" ngf-max-size="2MB" ngf-max-files="20">
                  <input type="hidden" ng-model="mailAttachment.fileName" />
                  <input type="hidden" ng-model="mailAttachment.newFileName" />
                </form>
              </div>
            </div>
            <div>
              <div class="col-md-12" ng-show="mailAttachments.length > 0" style="padding-left: 0px;">
                <div class="form-group no-margin">
                  <span ng-repeat="attachment in mailAttachments" style="margin-left: 5px;" class="tag"> <a target="_blank" href="{{$rootScope.basePath}}upload/mail_attachments/{{attachment.newFileName}}">{{attachment.fileName}}<!--<em style="font-size: 30px !important;" class="fa fa-file-image-o"></em>--></a>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="editorpanel">
          <textarea  class="mceEditor1" id="myarea"></textarea>
          <script type="text/javascript">
                                                setTimeout(function () {
                                                    tinyMCE.init({
                                                        // General options
                                                        mode: "specific_textareas",
                                                        editor_selector: "mceEditor1",
                                                        theme: "advanced",
                                                        //  plugins: "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave",
                                                        plugins: "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,wordcount,advlist,autosave",
                                                        // Theme options
                                                        paste_data_images: true,
                                                        paste_as_text: false,
                                                        relative_urls: false,
                                                        remove_script_host: false,
                                                        document_base_url: "<?=WEB_PATH?>/",
                                                        theme_advanced_buttons1: "bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect,bullist,numlist,cut,copy,paste,link,unlink,forecolor,backcolor|,undo,redo,",
                                                        //theme_advanced_buttons2: "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
                                                        theme_advanced_buttons2: "",
                                                        theme_advanced_buttons3: "",
                                                        theme_advanced_buttons4: "",
                                                        //                        theme_advanced_buttons2: ",pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,",
                                                        //                        theme_advanced_buttons3: "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
                                                        //                        theme_advanced_buttons4: "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak,restoredraft",
                                                        theme_advanced_toolbar_location: "top",
                                                        theme_advanced_toolbar_align: "left",
                                                        //theme_advanced_statusbar_location: "bottom",
                                                        theme_advanced_resizing: true,
                                                        // Example content CSS (should be your site CSS)
                                                        content_css: "css/content.css",
                                                        // Drop lists for link/image/media/template dialogs
                                                        template_external_list_url: "lists/template_list.js",
                                                        external_link_list_url: "lists/link_list.js",
                                                        external_image_list_url: "lists/image_list.js",
                                                        media_external_list_url: "lists/media_list.js",
                                                        // Style formats
                                                        /*
                                                         formats : {
                                                         alignleft : {selector : 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img', classes : 'left'},
                                                         aligncenter : {selector : 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img', classes : 'center'}
                                                         },
                                                         style_formats : [
                                                         {title : 'Test 1', selector : 'img', class : 'tablerow1'},
                                                         {title : 'Test 2', selector : 'img', class : 'classTest'}
                                                         ],
                                                         */
                                                        style_formats_merge: true,
                                                        style_formats: [
                                                            {
                                                                title: 'Image Right',
                                                                selector: 'img',
                                                                classes: 'classTest'
                                                            },
                                                            {
                                                                title: 'Image Left',
                                                                selector: 'img',
                                                                classes: 'classLeft'
                                                            }
                                                        ],
                                                        // Replace values for the template plugin
                                                        template_replace_values: {
                                                            username: "Some User",
                                                            staffid: "991234"
                                                        }
                                                    });
                                                }, 50);</script>
          <div class="clearfix"></div>
        </div>
      </div>

    </div>
      <!--col-md-9 ends here-->
    </div>
    <div class="col-md-9" ng-init="getMailFolders();" ng-show="defaultmail">
      <div class="d-wi no-padding d-wf">
        <div>
          <div class="hb" style="padding-top: 10px;padding-left: 14px;padding-right: 14px;">

            <i ng-if="header.subject" class="fa fa-envelope-open-o" aria-hidden="true" style="float: left;font-size: 18px;margin-right: 8px;margin-top: 4px;"></i>
            <div ng-bind="header.subject" class="pull-left header-sub"></div>

          <div class="pull-right" ng-if="header.subject">
            <a class="iic" ng-show="readmail" ng-click="reply(); getFolderMessageByParams('Rep: ');" title="Reply"><i class="fa fa-reply" aria-hidden="true"></i></a>
            <a class="iic"  title="Reply All" ng-show="readmail && replyall" ng-click="replyAll(); getFolderMessageByParams('Rep All: ');"><i class="fa fa-reply-all" aria-hidden="true"></i></a>
            <a class="iic"   title="Forward" ng-show="readmail" ng-click="forward(); getFolderMessageByParams('Fwd: ');"><i class="fa fa-share" aria-hidden="true"></i></a>
            <a class="iic"  title="Delete" ng-show="readmail" ng-click="moveMessage('INBOX.Trash');"><i class="fa fa-times" aria-hidden="true"></i></a>

            <div class="btn-group" ng-show="readmail">
              <a aria-expanded="true" title="Move To "aria-haspopup="true" data-toggle="dropdown" class="iic dropdown-toggle"><i class="fa fa-folder" aria-hidden="true"></i></a>
              <ul class="dropdown-menu" style="top: 35px;left: -130px;background: #333333;">
                <li ng-repeat="(key, value) in mailFolders">
                  <a href="javascript: void(0);" ng-click="moveMessage(key);" ng-bind="value"></a></li>
              </ul>
            </div>
            <a class="iic"  title="Print" ng-show="readmail" ng-click="printMessage();"><i class="fa fa-print" aria-hidden="true"></i></a>
          </div>
        </div>

        <div>
          <div class="inbox-area">
            <div ng-show="readmail" >

              <div class="col-md-9 no-padding" id="mailheader" style="word-break: break-all;">
                <p><strong ng-repeat="sender in header.sender" ng-bind="sender.personal"></strong></p>
                <p><strong style="width: 30px; font-weight: bold;" ng-show="header.to.length > 0">To:</strong> <span ng-repeat="to in header.to">{{to.personal + '<' + to.to + '>'}}&nbsp;</span></p>
                <div ng-show="attachments"> <strong style="width: 30px; font-weight: bold;" ng-show="attachments.length > 0">Attachment(s): </strong>

                  <div style="display:inline-block;" ng-repeat="attachment in attachments">
                    <a href="javascipt: void(0);" class="attachments" ng-click="downloadAttachment(attachment.mailno, attachment.ano, attachment.enc, attachment.method, attachment.name, attachment.partNum, attachment.subtype);">{{attachment.name}} </a>
                  </div>
                </div>
              </div>

              <div class="col-md-3 no-padding text-right">
                 <div ng-show="header.date" class="text-right f-d" title="Date">{{header.date}}</div>
              </div>

              <div class="col-md-12 no-padding">
                <p style="margin:0px;"><strong style="width: 20px;font-weight: bold;float: left;margin:0;" ng-show="header.cc.length > 0">Cc:</strong>
                  <div style="word-break: break-all;" >
                  <span ng-repeat="cc in header.cc">
                    {{cc.personal + '<' + cc.cc + '>'}};&nbsp;
                  </span>
                  </div>
                </p>
              </div>

              <div class="clearfix"></div>
              <br/>

              <iframe id="iframe1" frameborder="0"> </iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="mainModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" ng-bind="modalTitle"></h4>
        </div>
        <div class="modal-body">
          <p ng-bind="modalBody"></p>
        </div>
        <div class="modal-footer">
          <!--<button class="btn btn-sm btn-danger mr" data-dismiss="modal">OK</button>-->
          <button type="button" class="btn btn-default btn-sm" data-dismiss="modal" >Close</button>
        </div>
      </div>
      <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
  </div>
  <!-- /.modal -->
</div>
